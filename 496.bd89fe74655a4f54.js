"use strict";(self.webpackChunksceiba_ui=self.webpackChunksceiba_ui||[]).push([[496,341],{2496:(vt,q,c)=>{c.r(q),c.d(q,{CatalogModule:()=>Ai,createTranslateLoader:()=>xt});var d=c(6814),D=c(9862),k=c(1447),x=c(6223),A=c(9515),L=c(5061),N=c(4611),z=c(6729),a=c(3887),Y=c(8341),h=c(2787),j=c(2822),b=c(6825),g=c(7700),V=c(2651),E=c(1596),t=c(5879);function B(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"container-panel",2),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("content",e.filterPanel)}}let K=(()=>{class n{constructor(e){this._formBuilder=e,this.topMainOrganization=null,this.paramsChange=new t.vpe,this.filterPanel=null,this.institutionTree=[],this.topOrganizationPID="",this.filters=new Map}ngOnInit(){this.initPanels()}initFilters(){this.params.has("title")&&this.filters.set("title",this.params.get("title")),this.params.has("grupo_mes")&&this.filters.set("grupo_mes",this.params.get("grupo_mes")),this.params.has("organizations")&&this.filters.set("organizations",this.params.get("organizations")),this.params.has("indexes")&&this.filters.set("indexes",this.params.get("indexes")),this.params.has("subjects")&&this.filters.set("subjects",this.params.get("subjects")),this.params.has("source_type")&&this.filters.set("source_type",this.params.get("source_type"))}initPanels(){this.formGroup=this._formBuilder.group({}),this.initFilters(),this.formGroup.valueChanges.subscribe({next:e=>{console.log("emit values...",e),e.title&&e.title.length>3?this.filters.set("title",e.title):this.filters.delete("title"),e.identifier&&e.identifier.length>3?this.filters.set("identifier",e.identifier):this.filters.delete("identifier"),this.changeTermMultipleFilter(e,"organizations","id"),this.changeTermMultipleFilter(e,"subjects"),this.changeTermMultipleFilter(e,"grupo_mes"),this.changeTermMultipleFilter(e,"indexes"),e.source_type&&e.source_type.length>0?this.filters.set("source_type",e.source_type[0].value):this.filters.delete("source_type"),console.log("filters...",this.filters),console.log("values again...",e);let i={};this.filters.forEach((o,s)=>{console.log(o,s),""!=o&&(i[s]=o)}),console.log("emit res...",i),this.paramsChange.emit(i)},error:e=>{console.log("error: "+e+".")},complete:()=>{console.log("complete")}}),this.filterPanel={name:"filterPanel",label:"",description:"",iconName:"",controlType:a.xdy,formSection:this.formGroup,minWidth:"100%",formSectionContent:[{formControl:a.msU.getFormControlByDefault(),name:"title",label:"T\xedtulo",type:a.EIl.text,controlType:a.msU,required:!1,width:"100%",startHint:new a.io4(a.Q1i.start,""),value:this.filters.get("title")},{formControl:a.msU.getFormControlByDefault(),name:"identifier",label:"Identificador (ISSN, RNPS, URL...)",type:a.EIl.text,controlType:a.msU,required:!1,width:"100%",startHint:new a.io4(a.Q1i.start,""),value:this.filters.get("identifier")},{formControl:a.msU.getFormControlByDefault(),name:"source_type",label:"Tipo",controlType:a.AIS,startHint:new a.io4(a.Q1i.start,""),required:!1,width:"100%",extraContent:{multiple:!1,selectedTermsIds:this.filters.has("source_type")?this.filters.get("source_type").split(","):[],getOptions:()=>[{label:a.rRR.JOURNAL.label,value:a.rRR.JOURNAL.value},{label:a.rRR.REPOSITORY.label,value:a.rRR.REPOSITORY.value},{label:a.rRR.STUDENT.label,value:a.rRR.STUDENT.value},{label:a.rRR.POPULARIZATION.label,value:a.rRR.POPULARIZATION.value},{label:a.rRR.SERIAL.label,value:a.rRR.SERIAL.value},{label:a.rRR.WEBSITE.label,value:a.rRR.WEBSITE.value},{label:a.rRR.OTHER.label,value:a.rRR.OTHER.value}]}},{formControl:a.msU.getFormControlByDefault(),name:"organizations",label:"Organizaciones",controlType:a.kCA,startHint:new a.io4(a.Q1i.start,""),required:!1,width:"100%",extraContent:{multiple:!0,orgFilter:{type:"country",value:"Cuba"},selectedOrgsIds:this.filters.has("organizations")?this.filters.get("organizations").split(","):[]}},{formControl:a.msU.getFormControlByDefault(),name:"subjects",label:"Materias",controlType:a.Z7K,startHint:new a.io4(a.Q1i.start,""),required:!1,width:"100%",extraContent:{multiple:!0,selectedTermsIds:this.filters.has("subjects")?this.filters.get("subjects").split(","):[],vocab:a.r0t.SUBJECTS,level:0}},{formControl:a.msU.getFormControlByDefault(),name:"indexes",label:"Indizaciones",controlType:a.Z7K,startHint:new a.io4(a.Q1i.start,""),required:!1,width:"100%",extraContent:{multiple:!0,selectedTermsIds:this.filters.has("indexes")?this.filters.get("indexes").split(","):[],vocab:a.r0t.INDEXES,level:0}}]}}changeTermMultipleFilter(e,i,o="uuid"){if(e[i]){let s="";e[i].forEach(l=>{console.log(l),s=s.concat(l[o],",")}),s=s.slice(0,s.length-1),this.filters.set(i,s)}}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(x.QS))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-search-filters"]],inputs:{params:"params",topMainOrganization:"topMainOrganization"},outputs:{paramsChange:"paramsChange"},decls:2,vars:3,consts:[[4,"ngIf"],[3,"loading","position"],[3,"content"]],template:function(i,o){1&i&&(t.YNc(0,B,2,1,"ng-container",0),t._UZ(1,"toco-progress",1)),2&i&&(t.Q6J("ngIf",o.formGroup),t.xp6(1),t.Q6J("loading",!o.formGroup)("position","absolute"))},dependencies:[d.O5,a.t15,a.xdy]})}return n})();var C=c(6890),f=c(2296),T=c(1274),I=c(2596),S=c(617),G=c(1476),p=c(3814),w=c(7509),_=c(5195);function H(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"h2",6),t._uU(2,"ERROR: No Metadata"),t.qZA(),t._uU(3),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij(" SceibaID: ",e.id," ")}}function X(n,r){1&n&&(t.ynx(0),t._uU(1," | "),t.BQk())}function W(n,r){if(1&n&&(t.TgZ(0,"li",14),t._uU(1),t.YNc(2,X,2,0,"ng-container",5),t.qZA()),2&n){const e=r.$implicit,i=r.index,o=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",e," "),t.xp6(1),t.Q6J("ngIf",i<o.metadata.aliases.length-1)}}function $(n,r){if(1&n&&(t.TgZ(0,"ul",11)(1,"span",12),t._uU(2,"Conocida como:"),t.qZA(),t.YNc(3,W,3,2,"li",13),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("ngForOf",e.metadata.aliases)}}function tt(n,r){1&n&&(t.ynx(0),t._uU(1," | "),t.BQk())}function it(n,r){if(1&n&&(t.TgZ(0,"li",14)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,tt,2,0,"ng-container",5),t.qZA()),2&n){const e=r.$implicit,i=r.index,o=t.oxw(3).$implicit;t.xp6(2),t.hij(" ",e.name," "),t.xp6(1),t.Q6J("ngIf",i<o.metadata.organizations.length-1)}}function O(n,r){if(1&n&&(t.TgZ(0,"ul",11)(1,"span",12),t._uU(2,"Organizaciones asociadas:"),t.qZA(),t.YNc(3,it,4,2,"li",13),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("ngForOf",e.metadata.organizations)}}function Tt(n,r){1&n&&(t.ynx(0),t._uU(1," | "),t.BQk())}function lt(n,r){if(1&n&&(t.TgZ(0,"li",14),t._uU(1),t.YNc(2,Tt,2,0,"ng-container",5),t.qZA()),2&n){const e=r.$implicit,i=r.index,o=t.oxw(3).$implicit;t.xp6(1),t.AsE(" ",e.idtype,": ",e.value," "),t.xp6(1),t.Q6J("ngIf",i<o.metadata.identifiers.length-1)}}function at(n,r){if(1&n&&(t.TgZ(0,"ul",11)(1,"span",12),t._uU(2,"Identificadores:"),t.qZA(),t.YNc(3,lt,3,3,"li",13),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(3),t.Q6J("ngForOf",e.metadata.identifiers)}}function wt(n,r){1&n&&t._UZ(0,"hr",15)}const Jt=function(n,r){return[n,r]};function bt(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"h2",6)(2,"a",7),t._uU(3),t.qZA()(),t.TgZ(4,"span",8),t._uU(5),t.qZA(),t.YNc(6,$,4,1,"ul",9),t.YNc(7,O,4,1,"ul",9),t.YNc(8,at,4,1,"ul",9),t.YNc(9,wt,1,0,"hr",10),t.BQk()),2&n){const e=t.oxw(),i=e.$implicit,o=e.index,s=t.oxw(2);t.xp6(2),t.Q6J("routerLink",t.WLB(7,Jt,s.catalogPath,i.id)),t.xp6(1),t.hij(" ",i.metadata.name," "),t.xp6(2),t.hij(" SceibaID: ",i.id," "),t.xp6(1),t.Q6J("ngIf",i.metadata.aliases&&i.metadata.aliases.length>0),t.xp6(1),t.Q6J("ngIf",i.metadata.organizations&&i.metadata.organizations.length>0),t.xp6(1),t.Q6J("ngIf",i.metadata.identifiers&&i.metadata.identifiers.length>0),t.xp6(1),t.Q6J("ngIf",o<s.hitList.hits.length-1)}}const Ct=function(){return{margin:"1em 8px"}};function St(n,r){if(1&n&&(t.TgZ(0,"div",4),t.YNc(1,H,4,1,"ng-container",5),t.YNc(2,bt,10,10,"ng-container",5),t.qZA()),2&n){const e=r.$implicit;t.Q6J("ngStyle",t.DdM(3,Ct)),t.xp6(1),t.Q6J("ngIf",!e.metadata),t.xp6(1),t.Q6J("ngIf",e.metadata)}}function yt(n,r){if(1&n&&(t.TgZ(0,"mat-card",2)(1,"mat-card-content"),t.YNc(2,St,3,4,"div",3),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.hitList.hits)}}function It(n,r){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-content",16)(2,"h2"),t._uU(3,"No hay resultados para su b\xfasqueda..."),t.qZA()()())}let Zt=(()=>{class n{constructor(e){this.environment=e,this.catalogPath="",this.env=this.environment}ngOnInit(){}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.qAh))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-search-list"]],inputs:{hitList:"hitList",catalogPath:"catalogPath"},decls:3,vars:2,consts:[["class","mat-elevation-z0",4,"ngIf","ngIfElse"],["templateNotInfo",""],[1,"mat-elevation-z0"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[4,"ngIf"],[1,"mat-headline-6"],[2,"cursor","pointer",3,"routerLink"],["color","primary",1,"mat-caption"],["fxLayout","row wrap",4,"ngIf"],["class","hr-grey-ligth",4,"ngIf"],["fxLayout","row wrap"],[1,"mat-headline-8"],["class","li-margin-style mat-caption",4,"ngFor","ngForOf"],[1,"li-margin-style","mat-caption"],[1,"hr-grey-ligth"],[2,"height","400px"]],template:function(i,o){if(1&i&&(t.YNc(0,yt,3,1,"mat-card",0),t.YNc(1,It,4,0,"ng-template",null,1,t.W1O)),2&i){const s=t.MAs(2);t.Q6J("ngIf",o.hitList&&o.hitList.hits.length>0)("ngIfElse",s)}},dependencies:[d.sg,d.O5,d.PC,h.rH,_.a8,_.dn,p.xw,w.Zl],styles:[".p-40[_ngcontent-%COMP%]{padding-left:40px}.li-margin-style[_ngcontent-%COMP%]{margin:0 8px;list-style:none;text-transform:capitalize}.hr-grey-ligth[_ngcontent-%COMP%]{border-color:#0000001f}"]})}return n})();var J=c(4170),Dt=c(6007),y=c(3305);function At(n,r){1&n&&t._UZ(0,"mat-progress-bar",2)}function Vt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-action-row")(1,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().index,s=t.oxw(2);return t.KtG(s.addIndexAction(o))}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA()()()}}function Et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card-actions")(1,"button",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,s=t.oxw().index,l=t.oxw(2);return t.KtG(l.editIndexAction(s,o))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,s=t.oxw().index,l=t.oxw(2);return t.KtG(l.deleteIndexAction(s,o))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function Ot(n,r){if(1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title")(3,"mat-label"),t._uU(4),t.qZA()(),t.TgZ(5,"mat-card-subtitle")(6,"mat-label",5),t._uU(7,"URL: "),t.qZA(),t._uU(8),t.qZA()(),t.TgZ(9,"mat-card-content")(10,"mat-label",5),t._uU(11,"Cobertura: "),t.qZA(),t.TgZ(12,"mat-label"),t._uU(13),t.qZA()(),t.YNc(14,Et,7,0,"mat-card-actions",1),t.qZA()),2&n){const e=r.$implicit,i=t.oxw(3);t.xp6(4),t.Oqu(e.description),t.xp6(4),t.hij(" ",e.data.url," "),t.xp6(5),t.AsE(" ",e.data.initial_cover," - ",e.data.end_cover," "),t.xp6(1),t.Q6J("ngIf",i.editable)}}function Qt(n,r){if(1&n&&(t.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header"),t._uU(2),t.qZA(),t.YNc(3,Vt,4,0,"mat-action-row",1),t.YNc(4,Ot,15,5,"mat-card",3),t.qZA()),2&n){const e=r.$implicit,i=t.oxw(2);t.xp6(2),t.AsE(" ",e.dbclass.description," (",e.dblist.length,") "),t.xp6(1),t.Q6J("ngIf",i.editable),t.xp6(1),t.Q6J("ngForOf",e.dblist)}}function Ut(n,r){if(1&n&&(t.TgZ(0,"mat-accordion"),t.YNc(1,Qt,5,4,"mat-expansion-panel",3),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.selectedDatabases)}}let F=(()=>{class n{constructor(e,i){this.dialog=e,this.service=i,this.editable=!0,this.databases=null,this.selectedDatabases=null,this.loading=!0}ngOnInit(){if(this.loading=!0,console.log(),localStorage.getItem("vocab_indexes")&&""!=localStorage.getItem("vocab_indexes")){const e=JSON.parse(localStorage.getItem("vocab_indexes"));this.databases=e.data.tree.term_node,this.initIndexes()}else this.service.getTermsTreeByVocab(a.r0t.INDEXES,1).subscribe(e=>{e.data.tree.term_node&&(localStorage.setItem("vocab_indexes",JSON.stringify(e)),this.databases=e.data.tree.term_node,this.initIndexes())},e=>{console.log("ERROR: "+e+".")},()=>{})}ngOnChanges(){this.loading=!0,this.ngOnInit(),this.loading=!1}initIndexes(){this.loading=!0,this.selectedDatabases=new Array(this.databases.length),this._setSelectedDatabses(),this._setIndexesToSource(),console.log("**** SourceEditIndexesComponent *** complete process initIndexes",this.sourceData,this.selectedDatabases),this.loading=!1}_setSelectedDatabses(){for(let e=0;e<this.databases.length;e++)this.selectedDatabases[e]={dbclass:this.databases[e].term,dblist:this.sourceData.classifications.filter(i=>i.vocabulary==a.r0t.INDEXES&&null!=this.databases[e].children.find(o=>o.term.uuid==i.id))};for(let e=0;e<this.databases.length;e++)for(let i=0;i<this.selectedDatabases[e].dblist.length;i++)this.selectedDatabases[e].dblist[i].data||(this.selectedDatabases[e].dblist[i].data={}),this.selectedDatabases[e].dblist[i].data.url||(this.selectedDatabases[e].dblist[i].data.url=""),this.selectedDatabases[e].dblist[i].data.initial_cover||(this.selectedDatabases[e].dblist[i].data.initial_cover=""),this.selectedDatabases[e].dblist[i].data.end_cover||(this.selectedDatabases[e].dblist[i].data.end_cover="")}_setIndexesToSource(){this.sourceData.classifications=this.sourceData.classifications.filter(e=>e.vocabulary!=a.r0t.INDEXES);for(let e=0;e<this.selectedDatabases.length;e++){const i=this.selectedDatabases[e];if(i.dblist.length>0){const o=new a.CBV;o.id=i.dbclass.uuid,o.description=i.dbclass.description,o.vocabulary=i.dbclass.vocabulary_id,this.sourceData.classifications.push(o),this.sourceData.classifications=this.sourceData.classifications.concat(i.dblist)}}}addIndexAction(e){const o=this.databases[e].children.filter(s=>null==this.selectedDatabases[e].dblist.find(l=>l.id==s.term.uuid));o.length>0&&this.dialog.open(ct,{data:{dbclass:this.selectedDatabases[e].dbclass,options:o,editing:null,addIndex:s=>{this.dialog.closeAll(),this.selectedDatabases[e].dblist=this.selectedDatabases[e].dblist.filter(l=>l.id!=s.id),this.selectedDatabases[e].dblist.push(s),this._setIndexesToSource()}}})}editIndexAction(e,i){if(i){const s=this.databases[e].children.filter(l=>null==this.selectedDatabases[e].dblist.find(m=>m.id==l.term.uuid)||l.term.uuid==i.id);(s.length>0||i)&&this.dialog.open(ct,{data:{dbclass:this.selectedDatabases[e].dbclass,options:s,editing:i,addIndex:l=>{this.dialog.closeAll();const m=[];this.selectedDatabases[e].dblist.forEach(v=>{v.id!=l.id&&v.id!=i.id&&m.push(v)}),this.selectedDatabases[e].dblist=m,this.selectedDatabases[e].dblist.push(l),this._setIndexesToSource()}}})}}deleteIndexAction(e,i){this.selectedDatabases[e].dblist=this.selectedDatabases[e].dblist.filter(o=>o.id!=i.id),this._setIndexesToSource()}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.uw),t.Y36(a.X4d))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-edit-indexes"]],inputs:{sourceData:"sourceData",editable:"editable"},features:[t.TTD],decls:2,vars:2,consts:[["mode","indeterminate",4,"ngIf"],[4,"ngIf"],["mode","indeterminate"],[4,"ngFor","ngForOf"],["mat-icon-button","","aria-label","Adicionar","matTooltip","Adicionar",3,"click"],[2,"font-weight","bold"],["mat-icon-button","","aria-label","Editar","matTooltip","Editar",3,"click"],["mat-icon-button","","aria-label","Eliminar","matTooltip","Eliminar",3,"click"]],template:function(i,o){1&i&&(t.YNc(0,At,1,0,"mat-progress-bar",0),t.YNc(1,Ut,2,1,"mat-accordion",1)),2&i&&(t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading))},dependencies:[d.sg,d.O5,f.RK,I.gM,S.Hw,_.a8,_.hq,_.dn,_.dk,_.$j,_.n5,J.hX,Dt.pW,y.pp,y.ib,y.VG,y.yz]})}return n})(),ct=(()=>{class n{constructor(e,i,o){this.service=e,this._formBuilder=i,this.data=o,this.indexPanel=null,this.editing=null,this.dbclass=o.dbclass,this.options=o.options,o.editing&&(this.editing=o.editing),this.addIndex=o.addIndex}ngOnInit(){this.indexFormGroup=this._formBuilder.group({}),this.dbclass&&(this.indexPanel={label:this.editing?"Editar":"Adicionar",name:"indexPanel",controlType:a.xdy,description:"",iconName:"",formSection:this.indexFormGroup,formSectionContent:[{formControl:a.msU.getFormControlByDefault(),name:"indexes",label:this.dbclass.description,type:a.EIl.select_expr,controlType:a.Hr0,required:!0,width:"100%",value:this.editing?this.editing.id:null,extraContent:{multiple:!1,getOptions:e=>{const i=[];return this.options.forEach(o=>{i.push({value:o.term.uuid,label:o.term.description})}),i},selectionChange:e=>{console.log(e)}}},{formControl:a.Hgr.getFormControlByDefault(),name:"url",label:"URL",type:a.EIl.url,controlType:a.Hgr,required:!1,startHint:new a.io4(a.Q1i.start,"URL de la revista en el \xedndice."),width:"100%",value:this.editing?[this.editing.data.url]:""},{formControl:a.msU.getFormControlByDefault(),name:"initial_cover",label:"Cobertura inicio",type:a.EIl.text,controlType:a.msU,required:!1,startHint:new a.io4(a.Q1i.start,""),width:"45%",value:this.editing?[this.editing.data.initial_cover]:""},{formControl:a.msU.getFormControlByDefault(),name:"end_cover",label:"Cobertura",type:a.EIl.text,controlType:a.msU,required:!1,startHint:new a.io4(a.Q1i.start,""),width:"45%",value:this.editing?[this.editing.data.end_cover]:""}],actionLabel:"OK",action:{doit:e=>{if(this.indexFormGroup.valid){const i=new a.CBV;if(this.indexFormGroup.controls.indexes.value){const o=this.options.find(s=>s.term.uuid==this.indexFormGroup.controls.indexes.value);o&&(i.vocabulary=o.term.vocabulary_id,i.description=o.term.description,i.id=o.term.uuid,i.data={url:this.indexFormGroup.controls.url.value,initial_cover:this.indexFormGroup.controls.initial_cover.value,end_cover:this.indexFormGroup.controls.end_cover.value},this.addIndex(i))}}}}})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.X4d),t.Y36(x.QS),t.Y36(g.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-addindex"]],decls:1,vars:1,consts:[[3,"content"]],template:function(i,o){1&i&&t._UZ(0,"container-panel-action",0),2&i&&t.Q6J("content",o.indexPanel)},dependencies:[a.zk]})}return n})();var Nt=c(8525),jt=c(3680),Ft=c(8217);function Mt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-toolbar",2)(1,"span"),t._uU(2,"Adicionar"),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.addOrg(!0))}),t._uU(5," Organizaciones Cubanas "),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.addOrg(!1))}),t._uU(7," Otras "),t.qZA()()()}}function Rt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-action-row")(1,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,s=t.oxw();return t.KtG(s.setAsMain(o))}),t._uU(2," Establecer como Principal "),t.qZA(),t.TgZ(3,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().index,s=t.oxw();return t.KtG(s.removeInst(o))}),t._uU(4," Eliminar "),t.qZA()()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("disabled",1===e.length),t.xp6(2),t.Q6J("disabled",1===e.length)}}function Pt(n,r){if(1&n&&(t.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-panel-description"),t._uU(5),t.qZA()(),t.YNc(6,Rt,5,2,"mat-action-row",5),t._UZ(7,"org-view",6),t.qZA()),2&n){const e=r.$implicit,i=t.oxw();t.Q6J("expanded",!1),t.xp6(3),t.hij(" ",i.roles[e.role].label," "),t.xp6(2),t.hij(" ",e.name," "),t.xp6(1),t.Q6J("ngIf",i.editable),t.xp6(1),t.Q6J("org",e)("showContent",!1)}}function kt(n,r){if(1&n&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.s9C("value",e.value),t.xp6(1),t.Oqu(e.label)}}function Lt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Rol"),t.qZA(),t.TgZ(3,"mat-select",7),t.NdJ("valueChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.role=o)}),t.YNc(4,kt,2,2,"mat-option",8),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.ok())}),t._uU(6,"OK"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("required",!0)("value",e.role),t.xp6(1),t.Q6J("ngForOf",e.roles)}}function zt(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.org.name)}}function Yt(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label"),t._uU(2),t.qZA(),t.BQk()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.name)}}function Bt(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label"),t._uU(2,"Se a\xf1adir\xe1 tambi\xe9n: "),t.qZA(),t.YNc(3,Yt,3,1,"ng-container",11),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.parents)}}let Q=(()=>{class n{constructor(e,i){this.dialog=e,this.orgService=i,this.editable=!0,this.topMainOrganization=null,this.roles=a.GtV}ngOnInit(){this.sourceData.organizations=this.sourceData.organizations.filter(e=>e&&e.role)}ngOnChanges(){this.ngOnInit()}addOrg(e=!0,i=!1){this.dialog.open(Kt,{width:"90%",height:"100%",data:{cuban:e,canSelectRole:!0,selectOrg:(o,s,l)=>{this.addOrgToSource(o,s),l.forEach(m=>{this.addOrgToSource(m,a.GtV.COLABORATOR.value)})}}})}addOrgToSource(e,i){if(!this.sourceData.organizations.find(o=>o.id==e.id)){let o=new a.wR4;o.deepcopy(e),o.role=i,this.sourceData.organizations.push(o),a.GtV.MAIN.value==i&&this.setAsMain(e)}}setAsMain(e){this.sourceData.organizations.forEach(i=>{i.role=e.id==i.id?a.GtV.MAIN.value:a.GtV.COLABORATOR.value})}removeInst(e){const i=this.sourceData.organizations[e],o=new a.pF$(null,this.dialog),s=this.childToRemove(i);if(null==s){let l=this.getOrgToDelete(i),m=[],v="";for(let Z=0;Z<l.length;Z++){const nt=l[Z];m.push(this.sourceData.organizations[nt]),v+=this.sourceData.organizations[nt].name+", "}m.push(i),console.log(m),m.length>0&&o.showMessage(a.GL1.OK,v,a.PWx.dialog,"Se elimin\xf3 tambi\xe9n: ");let P=[];for(let Z=0;Z<this.sourceData.organizations.length;Z++)m.find(nt=>nt.id==this.sourceData.organizations[Z].id)||P.push(this.sourceData.organizations[Z]);console.log(P),this.sourceData.organizations=P}else o.showMessage(a.GL1.OK,s.name,a.PWx.dialog,"Para eliminar este elemento debe eliminar:")}childToRemove(e){if(e.relationships){for(let o=0;o<e.relationships.length;o++){const s=e.relationships[o];if(s.type==a.vd7.CHILD.value){const l=this.getIndexByPid(s.identifiers[0].value);if(null!=l)return this.sourceData.organizations[l]}}return null}}getOrgToDelete(e){let i=[];return e.relationships&&e.relationships.forEach(o=>{if(o.type==a.vd7.PARENT.value){const s=this.getIndexByPid(o.identifiers[0].value);s&&(i.push(s),i.concat(this.getOrgToDelete(this.sourceData.organizations[s])))}}),i}getIndexByPid(e){for(let i=0;i<this.sourceData.organizations.length;i++){const o=this.sourceData.organizations[i];for(let s=0;s<o.identifiers.length;s++){const l=o.identifiers[s];if(console.log(l.value+"=="+e),l.value==e)return console.log(l.value+"=="+e+"  iguales!!!"),i}}return null}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.uw),t.Y36(a.eY8))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-edit-organizations"]],inputs:{sourceData:"sourceData",editable:"editable",topMainOrganization:"topMainOrganization"},features:[t.TTD],decls:4,vars:2,consts:[["fxLayout","row wrap","fxLayoutAlign","space-between center","fxLayoutGap","20px",4,"ngIf"],[3,"expanded",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayoutAlign","space-between center","fxLayoutGap","20px"],["mat-raised-button","",3,"click"],[3,"expanded"],[4,"ngIf"],[3,"org","showContent"],["mat-stroked-button","",3,"disabled","click"]],template:function(i,o){1&i&&(t.ynx(0),t.YNc(1,Mt,8,0,"mat-toolbar",0),t.TgZ(2,"mat-accordion"),t.YNc(3,Pt,8,6,"mat-expansion-panel",1),t.qZA(),t.BQk()),2&i&&(t.xp6(1),t.Q6J("ngIf",o.editable),t.xp6(2),t.Q6J("ngForOf",o.sourceData.organizations))},dependencies:[d.sg,d.O5,f.lW,T.Ye,y.pp,y.ib,y.VG,y.yz,y.yK,y.u4,p.xw,p.SQ,p.Wh]})}return n})(),Kt=(()=>{class n{constructor(e,i,o){this.dialogRef=e,this.data=i,this.orgService=o,this.roles=[{label:"Principal",value:"MAIN"},{label:"Colaborador",value:"COLABORATOR"}],this.role=null,this.parents=new Array,this.placeholder="Buscar una organizaci\xf3n",this.canSelectRole=!0,this.cuban=!0}ngOnInit(){console.log(this.data),this.canSelectRole=this.data.canSelectRole,this.cuban=this.data.cuban,this.data.filter&&(this.placeholder="Buscar una organizaci\xf3n cubana")}onNoClick(){this.dialogRef.close()}selectedOrg(e){console.log(e),this.parents=new Array,this.org=null,e&&e.length>0&&(this.org=e[0],this.addParent(this.org))}addParent(e){e.relationships&&e.relationships.forEach(i=>{i.type==a.vd7.PARENT.value&&i.identifiers.length>0&&i.identifiers[0].value&&this.orgService.getOrganizationByPID(i.identifiers[0].value).subscribe({next:o=>{console.log(o),this.parents.push(o.metadata),this.addParent(o.metadata)}})})}ok(){this.canSelectRole?this.role&&(this.data.selectOrg(this.org,this.role,this.parents),this.dialogRef.close()):(this.data.selectOrg(this.org,a.GtV.COLABORATOR.value,this.parents),this.dialogRef.close())}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.so),t.Y36(g.WI),t.Y36(a.eY8))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-organizations-select-dialog"]],decls:13,vars:7,consts:[["mat-button-fab","",2,"right","0px","margin","5px","position","fixed",3,"click"],["mat-dialog-title",""],["mat-dialog-content","",1,"height-auto"],[3,"multipleSelection","showActions","filterCuban","showTitle","selectedOrgEmiter"],["mat-dialog-actions",""],["fxLayout","column wrap",2,"margin","10px"],[4,"ngIf"],["required","",3,"required","value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","",3,"click"],[3,"value"],[4,"ngFor","ngForOf"]],template:function(i,o){1&i&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return o.dialogRef.close()}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()(),t.TgZ(3,"h2",1),t._uU(4,"Seleccionar Organizaci\xf3n"),t.qZA(),t.TgZ(5,"div",2)(6,"sceiba-ui-search-select-org",3),t.NdJ("selectedOrgEmiter",function(l){return o.selectedOrg(l)}),t.qZA()(),t.TgZ(7,"div",4)(8,"div",5),t.YNc(9,Lt,7,3,"mat-form-field",6),t.qZA(),t.TgZ(10,"div",5),t.YNc(11,zt,2,1,"mat-label",6),t.YNc(12,Bt,4,1,"ng-container",6),t.qZA()()),2&i&&(t.xp6(6),t.Q6J("multipleSelection",!1)("showActions",!1)("filterCuban",o.cuban)("showTitle",!1),t.xp6(3),t.Q6J("ngIf",o.canSelectRole),t.xp6(2),t.Q6J("ngIf",o.org),t.xp6(1),t.Q6J("ngIf",o.parents.length>0))},dependencies:[d.sg,d.O5,f.lW,S.Hw,J.KE,J.hX,g.uh,g.xY,g.H8,Nt.gD,jt.ey,p.xw,Ft.Q],encapsulation:2})}return n})();var ot=c(6385),M=c(2557);function Gt(n,r){1&n&&(t.TgZ(0,"mat-label",4),t._uU(1,"Vac\xedo"),t.qZA())}function Ht(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-chip"),t._uU(2),t.qZA(),t.BQk()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",e.description," ")}}let Xt=(()=>{class n{constructor(){}ngOnInit(){null==this.terms&&(this.terms=new Array(0)),null==this.vocab_id&&(this.vocab_id=0),null==this.title&&(this.title="")}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-journal-view-version-term"]],inputs:{title:"title",vocab_id:"vocab_id",terms:"terms"},decls:8,vars:3,consts:[[2,"margin","1em","background-color","whitesmoke"],["class","text-muted text-through",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center",1,"mat-chip-list-stacked"],[4,"ngFor","ngForOf"],[1,"text-muted","text-through"]],template:function(i,o){1&i&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.YNc(4,Gt,2,0,"mat-label",1),t.qZA(),t.TgZ(5,"mat-card-content")(6,"mat-chip-listbox",2),t.YNc(7,Ht,3,1,"ng-container",3),t.qZA()()()),2&i&&(t.xp6(3),t.hij(" ",o.title," "),t.xp6(1),t.Q6J("ngIf",0==o.terms.length),t.xp6(3),t.Q6J("ngForOf",o.terms))},dependencies:[d.sg,d.O5,_.a8,_.dn,_.dk,_.n5,J.hX,M.HS,M.z2,p.xw,p.Wh],styles:[".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}"]})}return n})();function Wt(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-field",2),2&n){const e=t.oxw(2);t.Q6J("label","Nombre")("value",e.sourceData.name)}}function $t(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-field",2),2&n){const e=t.oxw(2);t.Q6J("label","Tipo")("value",e.tipos[e.sourceData.source_type].label)}}function te(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-field",2),2&n){const e=t.oxw(2);t.Q6J("label","Sistema")("value",e.sistemas[e.sourceData.source_system].label)}}function ee(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t.YNc(2,Wt,1,2,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(3,"p"),t.YNc(4,$t,1,2,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(5,"p"),t._UZ(6,"catalog-source-view-version-info-field",2),t.qZA(),t.TgZ(7,"p"),t._UZ(8,"catalog-source-view-version-info-field",2),t.qZA(),t.TgZ(9,"p"),t.YNc(10,te,1,2,"catalog-source-view-version-info-field",1),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.sourceData.title),t.xp6(2),t.Q6J("ngIf",e.sourceData.source_type),t.xp6(2),t.Q6J("label","URL")("value",e.getIdentifier(e.IdentifierSchemas.url)),t.xp6(2),t.Q6J("label","OAIURL")("value",e.getIdentifier(e.IdentifierSchemas.oaiurl)),t.xp6(2),t.Q6J("ngIf",e.sourceData.source_system)}}let ut=(()=>{class n{constructor(){this.IdentifierSchemas=a.dK2,this.tipos=a.rRR,this.sistemas=a.hjr}getIdentifier(e){return this.sourceData?this.sourceData.getIdentifierValue(e):""}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-view-version-info-default"]],inputs:{sourceData:"sourceData"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"label","value"]],template:function(i,o){1&i&&t.YNc(0,ee,11,7,"ng-container",0),2&i&&t.Q6J("ngIf",o.sourceData)},styles:[".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}"]})}return n})();function ne(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-field",1),2&n){const e=t.oxw(2);t.Q6J("label","Tipo")("value",e.tipos[e.journalData.source_type].label)}}function ie(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-field",1),2&n){const e=t.oxw(2);t.Q6J("label","Sistema")("value",e.sistemas[e.journalData.source_system].label)}}function ae(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function oe(n,r){if(1&n&&t._UZ(0,"div",8),2&n){const e=t.oxw(2);t.Q6J("innerHTML",e.journalData.description,t.oJD)}}function re(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._UZ(2,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(3,"p"),t._UZ(4,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(5,"p"),t._UZ(6,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(7,"p"),t.YNc(8,ne,1,2,"catalog-source-view-version-info-field",2),t.qZA(),t.TgZ(9,"mat-label",3),t._uU(10,"ISSN: "),t.qZA(),t.TgZ(11,"div",4)(12,"p"),t._UZ(13,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(14,"p"),t._UZ(15,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(16,"p"),t._UZ(17,"catalog-source-view-version-info-field",1),t.qZA()(),t.TgZ(18,"mat-label",3),t._uU(19,"RNPS: "),t.qZA(),t.TgZ(20,"div",4)(21,"p"),t._UZ(22,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(23,"p"),t._UZ(24,"catalog-source-view-version-info-field",1),t.qZA()(),t.TgZ(25,"p"),t._UZ(26,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(27,"p"),t._UZ(28,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(29,"p"),t.YNc(30,ie,1,2,"catalog-source-view-version-info-field",2),t.qZA(),t.TgZ(31,"p"),t._UZ(32,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(33,"p"),t._UZ(34,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(35,"p"),t._UZ(36,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(37,"p"),t._UZ(38,"catalog-source-view-version-info-field",1),t.ALo(39,"date"),t.qZA(),t.TgZ(40,"p"),t._UZ(41,"catalog-source-view-version-info-field",1),t.ALo(42,"date"),t.qZA(),t.TgZ(43,"p"),t._UZ(44,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(45,"mat-label",3),t._uU(46," Descripci\xf3n:"),t.qZA(),t.YNc(47,ae,2,0,"mat-label",5),t.YNc(48,oe,1,1,"div",6),t.TgZ(49,"mat-label",3),t._uU(50,"Redes Sociales:"),t.qZA(),t.TgZ(51,"div",4)(52,"p"),t._UZ(53,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(54,"p"),t._UZ(55,"catalog-source-view-version-info-field",1),t.qZA(),t.TgZ(56,"p"),t._UZ(57,"catalog-source-view-version-info-field",1),t.qZA()(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("label","T\xedtulo")("value",e.journalData.title),t.xp6(2),t.Q6J("label","Subt\xedtulo")("value",e.journalData.subtitle),t.xp6(2),t.Q6J("label","Nombre Abreviado")("value",e.journalData.shortname),t.xp6(2),t.Q6J("ngIf",e.journalData.source_type),t.xp6(5),t.Q6J("label","Impreso")("value",e.getIdentifier(e.IdentifierSchemas.issn_p)),t.xp6(2),t.Q6J("label","Electr\xf3nico")("value",e.getIdentifier(e.IdentifierSchemas.issn_e)),t.xp6(2),t.Q6J("label","De enlace")("value",e.getIdentifier(e.IdentifierSchemas.issn_l)),t.xp6(5),t.Q6J("label","Impreso")("value",e.getIdentifier(e.IdentifierSchemas.prnps)),t.xp6(2),t.Q6J("label","Electr\xf3nico")("value",e.getIdentifier(e.IdentifierSchemas.ernps)),t.xp6(2),t.Q6J("label","URL")("value",e.getIdentifier(e.IdentifierSchemas.url)),t.xp6(2),t.Q6J("label","OAIURL")("value",e.getIdentifier(e.IdentifierSchemas.oaiurl)),t.xp6(2),t.Q6J("ngIf",e.journalData.source_system),t.xp6(2),t.Q6J("label","Email")("value",e.journalData.email),t.xp6(2),t.Q6J("label","Seriadas Cubanas")("value",e.journalData.seriadas_cubanas),t.xp6(2),t.Q6J("label","Prop\xf3sito")("value",e.journalData.purpose),t.xp6(2),t.Q6J("label","A\xf1o de Inicio")("value",t.lcZ(39,42,e.journalData.start_year)),t.xp6(3),t.Q6J("label","A\xf1o de Fin")("value",t.lcZ(42,44,e.journalData.end_year)),t.xp6(3),t.Q6J("label","Frecuencia de Publicaci\xf3n")("value",e.journalData.frequency),t.xp6(3),t.Q6J("ngIf",!e.journalData.description),t.xp6(1),t.Q6J("ngIf",e.journalData.description),t.xp6(5),t.Q6J("label","Facebook")("value",e.journalData.socialNetworks.facebook),t.xp6(2),t.Q6J("label","Twitter")("value",e.journalData.socialNetworks.twitter),t.xp6(2),t.Q6J("label","Linkedin")("value",e.journalData.socialNetworks.linkedin)}}let dt=(()=>{class n{constructor(){this.IdentifierSchemas=a.dK2,this.tipos=a.rRR,this.sistemas=a.hjr}getIdentifier(e){return this.journalData?this.journalData.getIdentifierValue(e):""}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-view-version-info-journal"]],inputs:{journalData:"journalData"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"label","value"],[3,"label","value",4,"ngIf"],[2,"font-weight","bold"],[2,"margin-left","0.8em"],["class","text-muted text-through",4,"ngIf"],["class","e2e-inner-html-bound text-align-justify",3,"innerHTML",4,"ngIf"],[1,"text-muted","text-through"],[1,"e2e-inner-html-bound","text-align-justify",3,"innerHTML"]],template:function(i,o){1&i&&t.YNc(0,re,58,46,"ng-container",0),2&i&&t.Q6J("ngIf",o.journalData)},styles:[".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}"]})}return n})();function se(n,r){1&n&&(t.TgZ(0,"mat-card-header"),t._UZ(1,"mat-card-title"),t.TgZ(2,"mat-card-subtitle"),t._uU(3," Revisi\xf3n actual "),t.qZA()())}function le(n,r){1&n&&t._UZ(0,"mat-divider",12),2&n&&t.Q6J("inset",!0)}function ce(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-journal",13),2&n){const e=t.oxw(2);t.Q6J("journalData",e.sourceData)}}function ue(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-default",14,15),2&n){const e=t.oxw(2);t.Q6J("sourceData",e.sourceData)}}const _t=function(){return{margin:"1em"}};function de(n,r){if(1&n&&(t.TgZ(0,"mat-card"),t.YNc(1,se,4,0,"mat-card-header",1),t.YNc(2,le,1,1,"mat-divider",2),t.TgZ(3,"mat-card-content"),t.ynx(4,3),t.YNc(5,ce,1,1,"catalog-source-view-version-info-journal",4),t.YNc(6,ue,2,1,"catalog-source-view-version-info-default",5),t.BQk(),t._UZ(7,"mat-divider",6)(8,"catalog-journal-view-version-term",7)(9,"catalog-journal-view-version-term",8),t.TgZ(10,"mat-card",9)(11,"mat-card-header")(12,"mat-card-title"),t._uU(13,"Organizaciones:"),t.qZA()(),t.TgZ(14,"mat-card-content"),t._UZ(15,"catalog-source-edit-organizations",10),t.qZA()(),t.TgZ(16,"mat-card",9)(17,"mat-card-header")(18,"mat-card-title"),t._uU(19," Indizaciones:"),t.qZA()(),t.TgZ(20,"mat-card-content"),t._UZ(21,"catalog-source-edit-indexes",10),t.qZA()()(),t._UZ(22,"mat-divider",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.showVersionLabel),t.xp6(1),t.Q6J("ngIf",e.showVersionLabel),t.xp6(2),t.Q6J("ngSwitch",e.sourceVersion.data.source_type),t.xp6(1),t.Q6J("ngSwitchCase",e.sourceTypes.JOURNAL.value),t.xp6(2),t.Q6J("inset",!0),t.xp6(1),t.Q6J("terms",e.licenceTerms)("vocab_id",e.vocabularies.LICENCES),t.xp6(1),t.Q6J("terms",e.subjectTerms)("vocab_id",e.vocabularies.SUBJECTS),t.xp6(6),t.Q6J("sourceData",e.sourceData)("editable",!1)("ngStyle",t.DdM(16,_t)),t.xp6(6),t.Q6J("sourceData",e.sourceData)("editable",!1)("ngStyle",t.DdM(17,_t)),t.xp6(1),t.Q6J("inset",!0)}}function _e(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.value," ")}}function ge(n,r){if(1&n&&(t.TgZ(0,"mat-label",3),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("",e.emptyLabel," ")}}const gt=".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}";let rt=(()=>{class n{constructor(e,i){this._sourveService=e,this._snackBar=i,this.showVersionLabel=!0,this.panelOpenState=!1,this.IdentifierSchemas=a.dK2,this.sourceTypes=a.rRR,this.loading=!0}ngOnInit(){}ngOnChanges(){console.log("changes...."),this.loadSourceData(),this.loading=!1}loadSourceData(){null==this.sourceData&&(this.sourceData=this.sourceVersion.data.source_type==this.sourceTypes.JOURNAL.value?new a.tjp:new a.MMO),console.log("!!!!!!!!!!!!!!!!!!!0000!!!!!!!!!!!!!"),console.log(this.sourceVersion),this.sourceData.deepcopy(this.sourceVersion.data),console.log("!!!!!!!!!!!!!!!!!!!!!1!!!!!!!!!!!!!"),console.log(this.sourceData),this.dataBaseTerms=new Array,this.groupTerms=new Array,this.institutionTerms=new Array,this.licenceTerms=new Array,this.provinceTerms=new Array,this.subjectTerms=new Array,this.vocabularies=a.r0t,this.sourceData.classifications&&this.sourceData.classifications.forEach(e=>{switch(e.vocabulary.toString()){case a.r0t.CUBAN_INTITUTIONS:case a.r0t.EXTRA_INSTITUTIONS:this.institutionTerms.push(e);break;case a.r0t.INDEXES:this.dataBaseTerms.push(e);break;case a.r0t.INDEXES_CLASIFICATION:this.groupTerms.push(e);break;case a.r0t.LICENCES:this.licenceTerms.push(e);break;case a.r0t.CUBAN_PROVINCES:this.provinceTerms.push(e);break;case a.r0t.SUBJECTS:this.subjectTerms.push(e)}})}getIdentifier(e){return this.sourceData?this.sourceData.getIdentifierValue(e):""}editingSourceChange(e){console.log("*****llego....",e,this.sourceData),this.loadSourceData(),this.orgs.ngOnInit(),this.indexes.ngOnInit()}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.tkg),t.Y36(C.ux))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-view-version-info"]],viewQuery:function(i,o){if(1&i&&(t.Gf(Q,5),t.Gf(F,5)),2&i){let s;t.iGM(s=t.CRH())&&(o.orgs=s.first),t.iGM(s=t.CRH())&&(o.indexes=s.first)}},inputs:{sourceVersion:"sourceVersion",showVersionLabel:"showVersionLabel"},features:[t.TTD],decls:2,vars:2,consts:[[3,"loading"],[4,"ngIf"],["style","margin-bottom: 1em",3,"inset",4,"ngIf"],[3,"ngSwitch"],[3,"journalData",4,"ngSwitchCase"],[3,"sourceData",4,"ngSwitchDefault"],[2,"margin-bottom","1em","margin-top","1em",3,"inset"],["title","Licencia:",3,"terms","vocab_id"],["title","Materias:",3,"terms","vocab_id"],[2,"margin","1em","background-color","whitesmoke"],[3,"sourceData","editable","ngStyle"],[3,"inset"],[2,"margin-bottom","1em",3,"inset"],[3,"journalData"],[3,"sourceData"],["view",""]],template:function(i,o){1&i&&(t._UZ(0,"toco-progress",0),t.YNc(1,de,23,18,"mat-card",1)),2&i&&(t.Q6J("loading",o.loading),t.xp6(1),t.Q6J("ngIf",o.sourceVersion&&o.sourceData))},dependencies:[d.O5,d.PC,d.RF,d.n9,d.ED,_.a8,_.dn,_.dk,_.$j,_.n5,ot.d,a.t15,w.Zl,F,Q,Xt,ut,dt],styles:[gt]})}return n})(),et=(()=>{class n{constructor(){this.emptyLabel="Vac\xedo"}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-view-version-info-field"]],inputs:{label:"label",value:"value",emptyLabel:"emptyLabel"},decls:4,vars:3,consts:[[2,"font-weight","bold"],[4,"ngIf"],["class","text-muted text-through",4,"ngIf"],[1,"text-muted","text-through"]],template:function(i,o){1&i&&(t.TgZ(0,"mat-label",0),t._uU(1),t.qZA(),t.YNc(2,_e,2,1,"mat-label",1),t.YNc(3,ge,2,1,"mat-label",2)),2&i&&(t.xp6(1),t.hij("",o.label,": "),t.xp6(1),t.Q6J("ngIf",o.value),t.xp6(1),t.Q6J("ngIf",!o.value))},dependencies:[d.O5,J.hX],styles:[gt]})}return n})();function pe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"mat-drawer-container",6)(2,"mat-drawer",7,8),t._uU(4),t.TgZ(5,"catalog-search-filters",9),t.NdJ("paramsChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.filtersChange(o))}),t.qZA()(),t.TgZ(6,"div",10),t._UZ(7,"toco-progress",4),t.TgZ(8,"mat-paginator",11),t.NdJ("page",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.pageChange(o))}),t.qZA(),t._UZ(9,"catalog-search-list",12),t.TgZ(10,"mat-paginator",11),t.NdJ("page",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.pageChange(o))}),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("hasBackdrop",!1),t.xp6(2),t.hij(" ",e.mode," "),t.xp6(1),t.Q6J("params",e.filtersParams)("topMainOrganization",e.topMainOrganization),t.xp6(2),t.Q6J("loading",e.isLoading()),t.xp6(1),t.Q6J("length",e.length)("pageSize",e.pageSize)("pageIndex",e.pageIndex)("pageSizeOptions",e.pageSizeOptions),t.xp6(1),t.Q6J("hitList",e.dataSource)("catalogPath",e.catalogPath),t.xp6(1),t.Q6J("length",e.length)("pageSize",e.pageSize)("pageIndex",e.pageIndex)("pageSizeOptions",e.pageSizeOptions)}}const me=function(){return{width:"100%",height:"auto",padding:"16px","min-height":"56px"}},he=function(){return{"white-space":"normal"}};let fe=(()=>{class n{constructor(e,i,o,s,l,m,v,P){this.sourceServiceNoAuth=e,this.metadata=i,this.environment=o,this._snackBar=s,this.dialog=l,this.activatedRoute=m,this.orgService=v,this.router=P,this.loading=!0,this.initfilters=!1,this.hasErrors=!1,this.dataSource=new a.I7,this.columnsToDisplay=["title"],this.length=0,this.pageSize=5,this.pageIndex=0,this.pageSizeOptions=[5,10,15,20],this.layoutPosition=[{name:"Derecha",layout:"row-reverse",aling:"center baseline",width:"22"},{name:"Izquierda",layout:"row",aling:"center baseline",width:"22"},{name:"Arriba",layout:"column",aling:"center center",width:"90"},{name:"Abajo",layout:"column-reverse",aling:"center center",width:"90"}],this.currentlayout=this.layoutPosition[1],this.topOrganizationPID=null,this.topMainOrganization=null,this.catalogPath="",this.usetopMainOrganization=!1}onResize(e){this.drawer&&(this.drawer.mode=(0,E.tq)()?"over":"side",(0,E.K1)()||(this.drawer.opened=!(0,E.aZ)()))}ngAfterViewInit(){this.onResize(null)}ngOnInit(){let e=this.router.url.split("?");e.length>0&&(this.catalogPath=e[0]),this.activatedRoute.data.subscribe({next:i=>{if(i&&i.topOrganizationPID&&""!=i.topOrganizationPID)if(this.topOrganizationPID=i.topOrganizationPID,localStorage.getItem("topMainOrganization")&&""!=localStorage.getItem("topMainOrganization")){const o=JSON.parse(localStorage.getItem("topMainOrganization"));this.topMainOrganization=o,this.init()}else this.orgService.getOrganizationByPID(this.topOrganizationPID).subscribe({next:o=>{this.topMainOrganization=o,localStorage.setItem("topMainOrganization",JSON.stringify(o)),this.init()},error:o=>{console.log("ERROR",o)},complete:()=>{}});else this.init()},error:i=>{console.log(i)},complete:()=>{}})}init(){this.metadata.setStandardMeta("Cat\xe1logo de Revistas Cient\xedficas","",""),this.searchParams=new D.LE,this.activatedRoute.queryParamMap.subscribe({next:e=>{this.filtersParams=e,this.searchParams=e.has("size")?this.searchParams.set("size",e.get("size")):this.searchParams.set("size",this.pageSize.toString(10)),this.searchParams=e.has("page")?this.searchParams.set("page",e.get("page")):this.searchParams.set("page",(this.pageIndex+1).toString(10)),this.searchParams=e.has("source_type")?this.searchParams.set("source_type",e.get("source_type")):this.searchParams.delete("source_type");let i="";e.has("title")&&(i=i.concat("(name:"+e.get("title")+")")),e.has("identifier")&&(""!=i&&(i=this.queryAddAndOp(i)),i=i.concat('(identifiers.value:"'+e.get("identifier")+'")')),this.topMainOrganization&&(""!=i&&(i=this.queryAddAndOp(i)),i=i.concat("(organizations.id:"+this.topMainOrganization.id+")")),e.has("organizations")&&(i=this.queryAddAndOp(i),i=i.concat("(organizations.id:"),e.get("organizations").split(",").forEach((o,s,l)=>{i=i.concat(o),s<l.length-1&&(i=i.concat(" OR "))}),i=i.concat(")")),e.has("subjects")&&(i=this.queryAddAndOp(i),i=i.concat("(classifications.id:"),e.get("subjects").split(",").forEach((o,s,l)=>{i=i.concat(o),s<l.length-1&&(i=i.concat(" OR "))}),i=i.concat(")")),e.has("grupo_mes")&&(i=this.queryAddAndOp(i),i=i.concat("(classifications.id:"),e.get("grupo_mes").split(",").forEach((o,s,l)=>{i=i.concat(o),s<l.length-1&&(i=i.concat(" OR "))}),i=i.concat(")")),e.has("indexes")&&(i=this.queryAddAndOp(i),i=i.concat("(classifications.id:"),e.get("indexes").split(",").forEach((o,s,l)=>{i=i.concat(o),s<l.length-1&&(i=i.concat(" OR "))}),i=i.concat(")")),this.searchParams=this.searchParams.set("q",i),console.log(this.searchParams,"SEARCH PAAAAAARAMS"),this.fetchJournalData(),this.initfilters=!0,console.log("catalog comonent",e,this.filtersParams)},error:e=>{},complete:()=>{}})}queryAddAndOp(e){return""!=e?e+" AND ":e}ngOnChanges(){console.log("change")}filtersChange(e){this.filtersParams=(0,h.AF)(e),console.log(e),console.log(this.router.url),this.pageSize=5,this.pageIndex=0,e.page=this.pageIndex+1,e.size=this.pageSize,this.router.navigate(["."],{relativeTo:this.activatedRoute,queryParams:e,queryParamsHandling:"",replaceUrl:!0})}pageChange(e){this.pageSize=e.pageSize,this.pageIndex=e.pageIndex,this.router.navigate(["."],{relativeTo:this.activatedRoute,queryParams:{page:e.pageIndex+1,size:e.pageSize},queryParamsHandling:"merge"})}fetchJournalData(){this.loading=!0,this.sourceServiceNoAuth.getSources(this.searchParams).subscribe({next:e=>{this.length=e.hits.total,this.dataSource=e.hits,console.log("------------------------------------------",this.dataSource)},error:e=>{console.log("error: "+e+".")},complete:()=>{console.log("complete"),this.loading=!1}})}onScrollUp(){}isLoading(){return this.loading}openme(){const e=navigator.userAgent.match(/Android/i),i=navigator.userAgent.match(/BlackBerry/i),o=navigator.userAgent.match(/iPhone|iPad|iPod/i),s=navigator.userAgent.match(/Opera Mini/i),l=navigator.userAgent.match(/IEMobile/i);return!(null!=e||null!=i||null!=o||null!=s||null!=l)}changeLayoutPosition(e){this.currentlayout=this.layoutPosition[e]}viewJournal(e){this.sourceServiceNoAuth.getSourceByUUID(e).subscribe({next:i=>{if(console.log(i),i){let o=new a.ULI;o.data.deepcopy(i.metadata),o.id=e,this.dialog.open(xe,{data:{journalVersion:o}}).afterClosed()}else new a.pF$(this._snackBar).showMessage(a.GL1.serverError,"No fue posible encontrar la Revista")},error:i=>{console.log("error")},complete:()=>{}})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.isv),t.Y36(a.Doh),t.Y36(a.qAh),t.Y36(C.ux),t.Y36(g.uw),t.Y36(h.gz),t.Y36(a.eY8),t.Y36(h.F0))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-search"]],viewQuery:function(i,o){if(1&i&&t.Gf(V.jA,5),2&i){let s;t.iGM(s=t.CRH())&&(o.drawer=s.first)}},hostBindings:function(i,o){1&i&&t.NdJ("resize",function(l){return o.onResize(l)},!1,t.Jf7)},inputs:{usetopMainOrganization:"usetopMainOrganization"},features:[t.TTD],decls:10,vars:9,consts:[["fxLayout","row wrap","fxLayoutAlign","space-between center",3,"ngStyle"],[3,"ngStyle"],[1,"mat-h2"],["mat-icon-button","","matTooltip","Filtros",3,"click"],[3,"loading"],[4,"ngIf"],[2,"background-color","white"],["position","end",2,"min-width","30%",3,"hasBackdrop"],["drawer",""],["fxLayout","row wrap","fxLayout.xs","column wrap","fxLayoutAlign","start center","fxLayoutAlign.xs","center center","fxLayoutGap","1em",3,"params","topMainOrganization","paramsChange"],[1,"mx-1"],[3,"length","pageSize","pageIndex","pageSizeOptions","page"],[2,"height","50em",3,"hitList","catalogPath"]],template:function(i,o){1&i&&(t.TgZ(0,"mat-toolbar",0)(1,"span",1)(2,"span",2),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"button",3),t.NdJ("click",function(){return o.drawer.toggle()}),t.TgZ(6,"mat-icon"),t._uU(7,"filter_list"),t.qZA()()(),t._UZ(8,"toco-progress",4),t.YNc(9,pe,11,15,"div",5)),2&i&&(t.Q6J("ngStyle",t.DdM(7,me)),t.xp6(1),t.Q6J("ngStyle",t.DdM(8,he)),t.xp6(2),t.Oqu(t.lcZ(4,5,"CATALOG_TITLE")),t.xp6(5),t.Q6J("loading",!o.initfilters),t.xp6(1),t.Q6J("ngIf",o.initfilters))},dependencies:[d.O5,d.PC,f.RK,T.Ye,I.gM,S.Hw,V.jA,V.kh,G.NW,a.t15,p.xw,p.SQ,p.Wh,w.Zl,K,Zt,A.X$],styles:[".mx-1[_ngcontent-%COMP%]{margin:0 .5em}.height-auto[_ngcontent-%COMP%]{height:auto!important}"],data:{animation:[(0,b.X$)("detailExpand",[(0,b.SB)("collapsed",(0,b.oB)({height:"0px",minHeight:"0",display:"none"})),(0,b.SB)("expanded",(0,b.oB)({height:"*"})),(0,b.eR)("expanded <=> collapsed",(0,b.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}return n})(),xe=(()=>{class n{constructor(e,i){this.dialogRef=e,this.data=i}ngOnInit(){console.log(this.data)}onNoClick(){this.dialogRef.close()}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.so),t.Y36(g.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["dialog-catalog-journal-info"]],decls:2,vars:2,consts:[[1,"height-auto"],[3,"sourceVersion","showVersionLabel"]],template:function(i,o){1&i&&(t.TgZ(0,"mat-dialog-content",0),t._UZ(1,"catalog-source-view-version-info",1),t.qZA()),2&i&&(t.xp6(1),t.Q6J("sourceVersion",o.data.journalVersion)("showVersionLabel",!1))},dependencies:[g.xY,rt],encapsulation:2})}return n})();var pt=c(1884);let ve=(()=>{class n{constructor(e,i,o){this.oauthStorage=e,this._router=i,this.environment=o}canActivate(e,i){return!!JSON.parse(this.oauthStorage.getItem(a.FGX))}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(pt.Hy),t.LFG(h.F0),t.LFG(a.qAh))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Te=(()=>{class n{constructor(e,i,o){this.oauthStorage=e,this._router=i,this.environment=o}canActivate(e,i){const o=e.params.uuid;if(!JSON.parse(this.oauthStorage.getItem(a.FGX)))return!0;{console.log(this._router.url);let l=this._router.url.split("?");this._router.navigate(l.length>0?[l[0],o,"view"]:["/"])}}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(pt.Hy),t.LFG(h.F0),t.LFG(a.qAh))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var R=c(8257);const we=function(){return{width:"100%"}};function Je(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card-header",7)(1,"div",8)(2,"h2"),t._uU(3),t.qZA(),t.TgZ(4,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.cancelStepper())}),t._uU(5," Cancelar "),t.qZA()(),t.TgZ(6,"mat-card-subtitle"),t._uU(7),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.DdM(3,we)),t.xp6(2),t.hij(" ",e.pageTitle," "),t.xp6(4),t.Oqu(e.description)}}function be(n,r){1&n&&t._uU(0,"Identificadores")}function Ce(n,r){if(1&n&&(t.TgZ(0,"mat-step",10),t.YNc(1,be,1,0,"ng-template",11),t._UZ(2,"container-panel",12),t.TgZ(3,"div",13)(4,"button",14),t._uU(5," Siguiente "),t.qZA()()()),2&n){const e=t.oxw();t.Q6J("stepControl",e.identifiersFormGroup),t.xp6(2),t.Q6J("content",e.identifiersPanel)}}function Se(n,r){1&n&&t._uU(0,"Datos")}function ye(n,r){if(1&n&&(t.TgZ(0,"mat-step",10),t.YNc(1,Se,1,0,"ng-template",11),t._UZ(2,"container-panel",12),t.TgZ(3,"div",15)(4,"button",16),t._uU(5," Atr\xe1s "),t.qZA(),t.TgZ(6,"button",14),t._uU(7," Siguiente "),t.qZA()()()),2&n){const e=t.oxw();t.Q6J("stepControl",e.informationFormGroup),t.xp6(2),t.Q6J("content",e.informationPanel)}}function Ie(n,r){1&n&&t._uU(0,"Organizaciones")}function Ze(n,r){if(1&n&&(t.TgZ(0,"mat-step",10),t.YNc(1,Ie,1,0,"ng-template",11),t.TgZ(2,"h2"),t._uU(3,"Organizaciones"),t.qZA(),t._UZ(4,"catalog-source-edit-organizations",17),t.TgZ(5,"div",15)(6,"button",16),t._uU(7," Atr\xe1s "),t.qZA(),t.TgZ(8,"button",14),t._uU(9," Siguiente "),t.qZA()()()),2&n){const e=t.oxw();t.Q6J("stepControl",e.organizationFormGroup),t.xp6(4),t.Q6J("topMainOrganization",e.topMainOrganization)("sourceData",e.journalData)}}function De(n,r){1&n&&t._uU(0,"Indizaciones")}function Ae(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",15)(1,"button",16),t._uU(2," Atr\xe1s "),t.qZA(),t.TgZ(3,"button",20),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.indexerStepper())}),t._uU(4," Siguiente "),t.qZA()()}}function Ve(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",15)(1,"button",16),t._uU(2," Atr\xe1s "),t.qZA(),t.TgZ(3,"button",21),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.finishStepper())}),t._uU(4," Aceptar "),t.qZA()()}}function Ee(n,r){if(1&n&&(t.TgZ(0,"mat-step",10),t.YNc(1,De,1,0,"ng-template",11),t.TgZ(2,"h2"),t._uU(3,"Indizaciones"),t.qZA(),t._UZ(4,"catalog-source-edit-indexes",18),t.YNc(5,Ae,5,0,"div",19),t.YNc(6,Ve,5,0,"div",19),t.qZA()),2&n){const e=t.oxw();t.Q6J("stepControl",e.indexesFormGroup),t.xp6(4),t.Q6J("sourceData",e.journalData),t.xp6(1),t.Q6J("ngIf",e.showFinalStep),t.xp6(1),t.Q6J("ngIf",!e.showFinalStep)}}function Oe(n,r){1&n&&t._uU(0,"Fin")}function Qe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-step"),t.YNc(1,Oe,1,0,"ng-template",11),t.TgZ(2,"h3"),t._uU(3,"Ha completado el formulario"),t.qZA(),t.TgZ(4,"h4"),t._uU(5," Antes de aceptar puede revisar nuevamente los valores que ha introducido. "),t.qZA(),t._UZ(6,"container-panel",12),t.TgZ(7,"div",15)(8,"button",16),t._uU(9," Atr\xe1s "),t.qZA(),t.TgZ(10,"button",21),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.finishStepper())}),t._uU(11," Aceptar "),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("content",e.finalPanel)}}const Ue=function(){return{margin:"1em"}};let mt=(()=>{class n{constructor(e,i,o,s){this.metadata=e,this.snackBar=i,this.formBuilder=o,this._dialog=s,this.pageTitle="",this.journalData=null,this.journalVersion=null,this.showEditHeader=!1,this.description="",this.topMainOrganization=null,this.showFinalStep=!0,this.identifiersPanel=null,this.informationPanel=null,this.finalPanel=null,this.journalEditDone=new t.vpe,this.editCanceled=new t.vpe,this.loading=!0}ngOnInit(){this.journalData=new a.tjp,this.journalData.deepcopy(this.journalVersion.data),this.pageTitle=this.journalData.isNew?"Nueva Revista":"Editando : "+this.journalData.title,this.metadata.setStandardMeta(this.pageTitle,""),console.log("journal edit INIT"),this.resetStepper(),this.initStep2(),this.initStep0Identifiers(),this.initStep1(),this.initStep3(),this.initStepFinal(),this.loading=!1}resetStepper(){this.identifiersPanel=null,this.identifiersFormGroup=null,this.informationPanel=null,this.informationFormGroup=null,this.informationSocialFormGroup=null,this.organizationFormGroup=null,this.indexesFormGroup=null}initStep0Identifiers(){this.identifiersFormGroup=this.formBuilder.group({}),this.identifiersPanel={name:"identifiersPanel",label:"Identificadores",controlType:a.xdy,description:"",iconName:"",formSection:this.identifiersFormGroup,formSectionContent:[{formControl:a.msU.getFormControlByDefault(),name:"issn_l",label:"ISSN de Enlace",type:a.EIl.text,controlType:a.msU,required:!1,startHint:new a.io4(a.Q1i.start,"XXXX \u2013 XXXX"),width:"30%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.issn_l):""},{formControl:a.msU.getFormControlByDefault(),name:"issn_p",label:"ISSN Impreso",type:a.EIl.text,controlType:a.msU,required:!1,startHint:new a.io4(a.Q1i.start,"XXXX \u2013 XXXX"),width:"30%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.issn_p):""},{formControl:a.msU.getFormControlByDefault(),name:"issn_e",label:"ISSN Electr\xf3nico",type:a.EIl.text,controlType:a.msU,required:!1,startHint:new a.io4(a.Q1i.start,"XXXX \u2013 XXXX"),width:"30%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.issn_e):""},{formControl:a.fQc.getFormControlByDefault(),name:"rnps_p",label:"RNPS Impreso",type:a.EIl.rnps,controlType:a.fQc,required:!1,startHint:new a.io4(a.Q1i.start,"XXXX"),width:"45%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.prnps):""},{formControl:a.fQc.getFormControlByDefault(),name:"rnps_e",label:"RNPS Electr\xf3nico",type:a.EIl.rnps,controlType:a.fQc,required:!1,startHint:new a.io4(a.Q1i.start,"XXXX"),width:"45%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.ernps):""}]}}initStep1(){this.informationFormGroup=this.formBuilder.group({}),this.informationPanel={name:"informationPanel",label:"Datos de la Revista",description:"",iconName:"",controlType:a.xdy,formSection:this.informationFormGroup,formSectionContent:[{formControl:a.msU.getFormControlByDefault(),name:"title",label:"T\xedtulo",type:a.EIl.text,controlType:a.msU,required:!0,width:"100%",value:this.journalData?this.journalData.title:""},{formControl:a.msU.getFormControlByDefault(),name:"subtitle",label:"Subt\xedtulo",type:a.EIl.text,controlType:a.msU,required:!1,width:"30%",startHint:new a.io4(a.Q1i.start,""),value:this.journalData?this.journalData.subtitle:""},{formControl:a.msU.getFormControlByDefault(),name:"shortname",label:"T\xedtulo abreviado",type:a.EIl.text,controlType:a.msU,required:!1,width:"30%",startHint:new a.io4(a.Q1i.start,""),value:this.journalData?this.journalData.shortname:""},{formControl:a.msU.getFormControlByDefault(),name:"source_type",label:"Tipo de Revista",type:a.EIl.select_expr,controlType:a.Hr0,required:!0,width:"30%",value:this.journalData?this.journalData.source_type:"",extraContent:{multiple:!1,getOptions:()=>[{label:a.rRR.JOURNAL.label,value:a.rRR.JOURNAL.value},{label:a.rRR.STUDENT.label,value:a.rRR.STUDENT.value},{label:a.rRR.POPULARIZATION.label,value:a.rRR.POPULARIZATION.value}]}},{formControl:a.msU.getFormControlByDefault(),name:"description",label:"Descripci\xf3n",type:a.EIl.textarea,controlType:a.RpC,required:!1,width:"100%",value:this.journalData?this.journalData.description:""},{formControl:a.Hgr.getFormControlByDefault(),name:"url",label:"URL",type:a.EIl.url,controlType:a.Hgr,required:!0,startHint:new a.io4(a.Q1i.start,"Escriba una URL v\xe1lida."),width:"100%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.url):""},{formControl:a.Hgr.getFormControlByDefault(),name:"oaiurl",label:"OAI-PMH",type:a.EIl.url,controlType:a.Hgr,required:!1,startHint:new a.io4(a.Q1i.start,"Escriba una URL v\xe1lida."),width:"100%",value:this.journalData?this.journalData.getIdentifierValue(a.dK2.oaiurl):""},{formControl:a.vhw.getFormControlByDefault(),name:"email",label:"Correo Electr\xf3nico",type:a.EIl.email,controlType:a.vhw,required:!1,startHint:new a.io4(a.Q1i.start,"Escriba un email v\xe1lido."),width:"45%",value:this.journalData?this.journalData.email:""},{formControl:a.msU.getFormControlByDefault(),name:"source_system",label:"Tipo de Sistema que soporta la revista",type:a.EIl.select_expr,controlType:a.Hr0,required:!1,width:"45%",value:this.journalData?this.journalData.source_system:"",extraContent:{multiple:!1,getOptions:()=>[{label:a.hjr.OJS.label,value:a.hjr.OJS.value},{label:a.hjr.CMS.label,value:a.hjr.CMS.value},{label:a.hjr.OTHER.label,value:a.hjr.OTHER.value}]}},{formControl:a.msU.getFormControlByDefault(),name:"licence",label:"Licencia",type:a.EIl.vocabulary,controlType:a.Z7K,required:!1,width:"45%",extraContent:{multiple:!1,selectedTermsIds:this.journalData?this.journalData.classifications.map(e=>e.id):null,vocab:a.r0t.LICENCES,level:0}},{formControl:a.msU.getFormControlByDefault(),name:"subjects",label:"Materia",type:a.EIl.vocabulary,controlType:a.Z7K,required:!1,width:"45%",extraContent:{multiple:!1,selectedTermsIds:this.journalData?this.journalData.classifications.map(e=>e.id):null,vocab:a.r0t.SUBJECTS,level:0}},{formControl:a.msU.getFormControlByDefault(),name:"start_year",label:"A\xf1o de inicio",type:a.EIl.datepicker,controlType:a.SPv,required:!1,width:"30%",value:this.journalData?this.journalData.start_year:"",extraContent:{minYear:1492,maxYear:new Date(Date.now())}},{formControl:a.msU.getFormControlByDefault(),name:"end_year",label:"A\xf1o final",type:a.EIl.datepicker,controlType:a.SPv,required:!1,width:"30%",value:this.journalData?this.journalData.end_year:"",extraContent:{minYear:1492,maxYear:new Date(Date.now())}},{formControl:a.msU.getFormControlByDefault(),name:"frequency",label:"Frecuencia",type:a.EIl.select_expr,controlType:a.Hr0,required:!1,startHint:new a.io4(a.Q1i.start,""),width:"30%",value:this.journalData?this.journalData.frequency:"",extraContent:{multiple:!1,getOptions:()=>[{label:"Anual",value:"anual"},{label:"Semestral",value:"semestral"},{label:"Cuatrimestral",value:"cuatrimestral"},{label:"Trimestral",value:"trimestral"},{label:"Bimestral",value:"bimestral"},{label:"Publicaci\xf3n continua",value:"publicaci\xf3n continua"},{label:"Otro",value:"otro"}]}},{formControl:a.Hgr.getFormControlByDefault(),name:"facebook",label:"Facebook",type:a.EIl.url,controlType:a.Hgr,required:!1,width:"30%",value:this.journalData?this.journalData.socialNetworks.facebook:""},{formControl:a.Hgr.getFormControlByDefault(),name:"twitter",label:"Twitter",type:a.EIl.url,controlType:a.Hgr,required:!1,width:"30%",value:this.journalData?this.journalData.socialNetworks.twitter:""},{formControl:a.Hgr.getFormControlByDefault(),name:"linkedin",label:"LinkedIN",type:a.EIl.url,controlType:a.Hgr,required:!1,width:"30%",value:this.journalData?this.journalData.socialNetworks.linkedin:""}]}}initStep2(){this.organizationFormGroup=this.formBuilder.group({institutions:new x.p4("")})}initStep3(){this.indexesFormGroup=this.formBuilder.group({})}indexerStepper(){}initStepFinal(){this.finalFormGroup=this.formBuilder.group({}),this.finalPanel={name:"finalPanel",label:"",description:"",iconName:"",formSection:this.finalFormGroup,controlType:a.xdy,formSectionContent:[{formControl:a.msU.getFormControlByDefault(),name:"comment",label:"Puede agregar aqu\xed un comentario.",type:a.EIl.textarea,controlType:a.RpC,required:!1,startHint:new a.io4(a.Q1i.start,""),width:"100%",minWidth:"100%",value:""}]}}fillJournalFields(){this.journalData.setIdentifierValue(a.dK2.issn_p,this.identifiersFormGroup.value.issn_p),this.journalData.setIdentifierValue(a.dK2.issn_e,this.identifiersFormGroup.value.issn_e),this.journalData.setIdentifierValue(a.dK2.issn_l,this.identifiersFormGroup.value.issn_l),this.journalData.setIdentifierValue(a.dK2.prnps,this.identifiersFormGroup.value.rnps_p),this.journalData.setIdentifierValue(a.dK2.ernps,this.identifiersFormGroup.value.rnps_e),console.log(this.informationFormGroup),this.journalData.deepcopy(this.informationFormGroup.value),this.journalData.socialNetworks.deepcopy(this.informationFormGroup.value),this.journalData.name=this.journalData.title,this.journalData.setIdentifierValue(a.dK2.url,this.informationFormGroup.value.url),this.journalData.setIdentifierValue(a.dK2.oaiurl,this.informationFormGroup.value.oaiurl),this.journalData.source_type=this.informationFormGroup.value.source_type;const e=this.journalData.classifications.filter(i=>i.vocabulary==a.r0t.INDEXES);this.journalData.classifications=[],this.informationFormGroup.value.licence&&this.informationFormGroup.value.licence.forEach(i=>{const o=new a.CBV;o.description=i.description,o.id=i.uuid,o.vocabulary=i.vocabulary_id,this.journalData.classifications.push(o)}),this.informationFormGroup.value.subjects&&this.informationFormGroup.value.subjects.forEach(i=>{const o=new a.CBV;o.description=i.description,o.id=i.uuid,o.vocabulary=i.vocabulary_id,this.journalData.classifications.push(o)}),console.log(e),this.journalData.classifications=this.journalData.classifications.concat(e),this.journalData._save_info.comment=this.finalFormGroup.value.comment,this.journalVersion.comment=this.finalFormGroup.value.comment,this.journalVersion.data.deepcopy(this.journalData),console.log("QQQQQQQQQQQQQQQQQQQQQQQQ"),console.log(this.journalData)}finishStepper(){this.fillJournalFields(),console.log(this.journalData,this.journalVersion),0==this.journalData.identifiers.length&&""==this.journalVersion.source_uuid?new a.pF$(null,this._dialog).showMessage(a.GL1.OK,"Una revista debe tener titulo, al menos un identificador persistente y una url, revise sus datos.",a.PWx.dialog,"Error","50%"):this.journalEditDone.emit(this.journalVersion)}cancelStepper(){this.editCanceled.emit(!0)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.Doh),t.Y36(C.ux),t.Y36(x.QS),t.Y36(g.uw))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-edit-journal"]],inputs:{journalVersion:"journalVersion",showEditHeader:"showEditHeader",description:"description",topMainOrganization:"topMainOrganization",showFinalStep:"showFinalStep"},outputs:{journalEditDone:"journalEditDone",editCanceled:"editCanceled"},decls:11,vars:10,consts:[[3,"loading"],[3,"ngStyle"],["fxLayout","column wrap","fxLayoutAlign","start center",4,"ngIf"],["labelPosition","end",3,"linear"],["stepper",""],[3,"stepControl",4,"ngIf"],[4,"ngIf"],["fxLayout","column wrap","fxLayoutAlign","start center"],["fxLayout","row wrap","fxLayoutAlign","space-between center",3,"ngStyle"],["mat-stroked-button","","color","warn",3,"click"],[3,"stepControl"],["matStepLabel",""],[3,"content"],["fxLayout","row wrap","fxLayoutAlign","end center"],["mat-stroked-button","","color","primary","matStepperNext",""],["fxLayout","row wrap","fxLayoutAlign","space-between center"],["mat-stroked-button","","color","accent","matStepperPrevious",""],[3,"topMainOrganization","sourceData"],[3,"sourceData"],["fxLayout","row wrap","fxLayoutAlign","space-between center",4,"ngIf"],["mat-stroked-button","","color","primary","matStepperNext","",3,"click"],["mat-stroked-button","","color","primary",3,"click"]],template:function(i,o){1&i&&(t._UZ(0,"toco-progress",0),t.TgZ(1,"mat-card",1),t.YNc(2,Je,8,4,"mat-card-header",2),t.TgZ(3,"mat-card-content")(4,"mat-horizontal-stepper",3,4),t.YNc(6,Ce,6,2,"mat-step",5),t.YNc(7,ye,8,2,"mat-step",5),t.YNc(8,Ze,10,3,"mat-step",5),t.YNc(9,Ee,7,4,"mat-step",5),t.YNc(10,Qe,12,1,"mat-step",6),t.qZA()()()),2&i&&(t.Q6J("loading",o.loading),t.xp6(1),t.Q6J("ngStyle",t.DdM(9,Ue)),t.xp6(1),t.Q6J("ngIf",o.showEditHeader),t.xp6(2),t.Q6J("linear",!0),t.xp6(2),t.Q6J("ngIf",o.identifiersPanel),t.xp6(1),t.Q6J("ngIf",o.informationPanel),t.xp6(1),t.Q6J("ngIf",o.organizationFormGroup),t.xp6(1),t.Q6J("ngIf",o.indexesFormGroup),t.xp6(1),t.Q6J("ngIf",o.showFinalStep))},dependencies:[d.O5,d.PC,f.lW,_.a8,_.dn,_.dk,_.$j,R.C0,R.VY,R.Vq,R.Ic,R.fd,a.t15,a.xdy,p.xw,p.Wh,w.Zl,F,Q]})}return n})();function Ne(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.resetEdit())}),t.TgZ(1,"mat-icon"),t._uU(2,"cached"),t.qZA()()}}function je(n,r){if(1&n&&t._UZ(0,"container-panel-action",6),2&n){const e=t.oxw();t.Q6J("content",e.findPanel)}}function Fe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"catalog-source-edit-journal",10),t.NdJ("journalEditDone",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.finishInclusion())}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("journalVersion",e.versionToEdit)("showEditHeader",!1)("description","Complete y compruebe todos los datos solicitados.")("topMainOrganization",e.topMainOrganization)}}function Me(n,r){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.AsE(" ",e.sourceType.JOURNAL.value," ",e.source.source_type,"\n")}}function Re(n,r){if(1&n&&(t.ynx(0,7),t.YNc(1,Fe,1,4,"catalog-source-edit-journal",8),t.YNc(2,Me,2,2,"p",9),t.BQk()),2&n){const e=t.oxw();t.Q6J("ngSwitch",e.source.source_type),t.xp6(1),t.Q6J("ngSwitchCase",e.sourceType.JOURNAL.value)}}let Pe=(()=>{class n{constructor(e,i,o,s,l,m,v){this.sourceService=e,this.sourceServiceNoAuth=i,this._formBuilder=o,this.dialog=s,this._router=l,this.orgService=m,this.environment=v,this.source=null,this.versionToEdit=null,this.topOrganizationPID=null,this.topMainOrganization=null,this.sourceType=a.rRR,this.sourceStatus=a.aFH,this.loading=!1,this.isStartProcess=!0}ngOnInit(){if(localStorage.getItem("topMainOrganization")&&""!=localStorage.getItem("topMainOrganization")){const e=JSON.parse(localStorage.getItem("topMainOrganization"));this.topMainOrganization=e}else this.environment.topOrganizationPID&&(this.topOrganizationPID=this.environment.topOrganizationPID,this.orgService.getOrganizationByPID(this.topOrganizationPID).subscribe(e=>{this.topMainOrganization=e},e=>{console.log("error")},()=>{}));this.findFormGroup=this._formBuilder.group({}),this.findPanel={name:"panel",controlType:a.zk,label:"Introduzca un identificador de la revista que desea incluir.",description:"",iconName:"",formSection:this.findFormGroup,formSectionContent:[{formControl:a.msU.getFormControlByDefault(),name:"idenfifier",label:"Identificador",type:a.EIl.text,controlType:a.msU,required:!0,startHint:new a.io4(a.Q1i.start,"(ISSN, RNPS, URL, T\xedtulo)"),width:"100%"}],actionLabel:"Buscar",action:{doit:()=>{const e=this.findFormGroup.controls.idenfifier.value;this.loading=!0;const i=new a.pF$(null,this.dialog);let o="No hemos encontrado informaci\xf3n",s="Debe completar todos los datos solicitados para incluir la revista.";this.sourceServiceNoAuth.getSourceByPID(e).subscribe({next:l=>{if(l&&l.metadata){let m=l.metadata;m.source_type===this.sourceType.JOURNAL.value?(this.source=new a.t3C,this.versionToEdit=new a.ULI,this.source.deepcopy(l.metadata),this.versionToEdit.data.deepcopy(l.metadata),this.versionToEdit.source_uuid=l.id,o="Tenemos informaci\xf3n sobre la revista",s="Compruebe y complete todos los datos solicitados para incluir la revista."):(o="No soportado",s="El identificador: "+e+"no pertenece a una revista. Este sistema no soporta esta funcionalidad.",this.source=new a.Hw6,this.source.data.deepcopy(m)),this.isStartProcess=!1,this.loading=!1,i.showMessage(a.GL1.OK,s,a.PWx.dialog,o)}l&&"error"==l.status&&(this.source=new a.t3C,this.versionToEdit=new a.ULI,this.source.isNew=!0,this.source.source_type=this.sourceType.JOURNAL.value,this.source.source_status=this.sourceStatus.TO_REVIEW.value,this.versionToEdit.data.source_status=this.sourceStatus.TO_REVIEW.value,this.versionToEdit.data.source_type=this.sourceType.JOURNAL.value,this.versionToEdit.isNew=!0,this.loading=!1,this.isStartProcess=!1,this.versionToEdit.source_uuid="",i.showMessage(a.GL1.OK,s,a.PWx.dialog,o),console.log("**************************",this.source,this.versionToEdit))},error:l=>{},complete:()=>{}})}}}}journalEditDone(){}resetEdit(){this.source=null,this.isStartProcess=!0}finishInclusion(){this.dialog.open(qe,{data:{accept:i=>{this.dialog.closeAll(),console.log(" KONIEC",i,this.versionToEdit);let o=this.versionToEdit.source_uuid;""==this.versionToEdit.source_uuid&&this.versionToEdit.data.identifiers.length>0&&(o=this.versionToEdit.data.identifiers[0].value),""!=o&&this.sourceService.newSource(this.versionToEdit,o,i).subscribe({next:s=>{console.log(" KONIEC",s);let l=this._router.url.split("/");console.log(l),this._router.navigate([l[0],l[1],l[2],s.data.source.id,"view"])},error:s=>{console.log("error: "+s+".")},complete:()=>{console.log("complete")}})}}})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.tkg),t.Y36(a.isv),t.Y36(x.QS),t.Y36(g.uw),t.Y36(h.F0),t.Y36(a.eY8),t.Y36(a.qAh))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-inclusion"]],decls:8,vars:4,consts:[[3,"loading"],["fxLayout","row wrap","fxLayoutAlign","space-between center"],["mat-icon-button","","aria-label","Reset","matTooltip","Comenzar de nuevo",3,"click",4,"ngIf"],[3,"content",4,"ngIf"],[3,"ngSwitch",4,"ngIf"],["mat-icon-button","","aria-label","Reset","matTooltip","Comenzar de nuevo",3,"click"],[3,"content"],[3,"ngSwitch"],[3,"journalVersion","showEditHeader","description","topMainOrganization","journalEditDone",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"journalVersion","showEditHeader","description","topMainOrganization","journalEditDone"]],template:function(i,o){1&i&&(t._UZ(0,"toco-progress",0),t.TgZ(1,"mat-toolbar")(2,"mat-toolbar-row",1)(3,"h1"),t._uU(4,"Inclusi\xf3n de Revista"),t.qZA(),t.YNc(5,Ne,3,0,"button",2),t.qZA()(),t.YNc(6,je,1,1,"container-panel-action",3),t.YNc(7,Re,3,2,"ng-container",4)),2&i&&(t.Q6J("loading",o.loading),t.xp6(5),t.Q6J("ngIf",!o.isStartProcess),t.xp6(1),t.Q6J("ngIf",o.isStartProcess),t.xp6(1),t.Q6J("ngIf",o.source&&o.versionToEdit))},dependencies:[d.O5,d.RF,d.n9,d.ED,f.RK,T.Ye,T.rD,I.gM,S.Hw,a.t15,a.zk,p.xw,p.Wh,mt]})}return n})(),qe=(()=>{class n{constructor(e,i){this.dialogRef=e,this.data=i,this.accept=i.accept}onAcept(){this.accept("editor")}onCancel(){this.dialogRef.close()}ngOnInit(){}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.so),t.Y36(g.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-journal-addinstextra"]],decls:11,vars:1,consts:[["markdown","",2,"margin","2em",3,"src"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._uU(3,"Acuerdo legal"),t.qZA()(),t.TgZ(4,"mat-card-content"),t._UZ(5,"div",0),t.qZA(),t.TgZ(6,"mat-card-actions")(7,"button",1),t.NdJ("click",function(){return o.onAcept()}),t._uU(8,"Aceptar"),t.qZA(),t.TgZ(9,"button",2),t.NdJ("click",function(){return o.onCancel()}),t._uU(10,"Cancelar"),t.qZA()()()),2&i&&(t.xp6(5),t.Q6J("src","assets/markdown/catalog/source-inclusion-agreement.md"))},dependencies:[f.lW,_.a8,_.hq,_.dn,_.dk,_.n5,N.lF],encapsulation:2})}return n})();function ke(n,r){if(1&n&&(t.TgZ(0,"div",4)(1,"span",5),t._uU(2),t.qZA(),t.TgZ(3,"span",6),t._uU(4),t.qZA(),t.TgZ(5,"span",7),t._uU(6),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.hij(" ",e.source.data.name,""),t.xp6(2),t.hij(" SceibaID: ",e.source.source_uuid," "),t.xp6(2),t.hij(" Tipo: Fuente - ",e.source_type_label," ")}}function Le(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info",12,13),2&n){const e=t.oxw(3);t.Q6J("sourceVersion",e.source)("showVersionLabel",!1)}}function ze(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info-field",14),2&n){const e=t.oxw(4);t.Q6J("label","Tipo")("value",e.sourceType[e.source.data.source_type].label)}}const Ye=function(){return{margin:"1em"}};function Be(n,r){if(1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"p"),t._UZ(3,"catalog-source-view-version-info-field",14),t.qZA(),t.TgZ(4,"p"),t.YNc(5,ze,1,2,"catalog-source-view-version-info-field",15),t.qZA(),t.TgZ(6,"mat-label",16),t._uU(7,"ISSN: "),t.qZA(),t.TgZ(8,"div",17)(9,"p"),t._UZ(10,"catalog-source-view-version-info-field",14),t.qZA(),t.TgZ(11,"p"),t._UZ(12,"catalog-source-view-version-info-field",14),t.qZA(),t.TgZ(13,"p"),t._UZ(14,"catalog-source-view-version-info-field",14),t.qZA()(),t.TgZ(15,"mat-label",16),t._uU(16,"RNPS: "),t.qZA(),t.TgZ(17,"div",17)(18,"p"),t._UZ(19,"catalog-source-view-version-info-field",14),t.qZA(),t.TgZ(20,"p"),t._UZ(21,"catalog-source-view-version-info-field",14),t.qZA()(),t.TgZ(22,"p"),t._UZ(23,"catalog-source-view-version-info-field",14),t.qZA(),t.TgZ(24,"mat-card",18)(25,"mat-card-header")(26,"mat-card-title"),t._uU(27,"Organizaciones:"),t.qZA()(),t.TgZ(28,"mat-card-content"),t._UZ(29,"catalog-source-edit-organizations",19),t.qZA()()()()),2&n){const e=t.oxw(3);t.xp6(3),t.Q6J("label","T\xedtulo")("value",e.source.data.name),t.xp6(2),t.Q6J("ngIf",e.source.data.source_type),t.xp6(5),t.Q6J("label","Impreso")("value",e.getIdentifier(e.IdentifierSchemas.issn_p)),t.xp6(2),t.Q6J("label","Electr\xf3nico")("value",e.getIdentifier(e.IdentifierSchemas.issn_e)),t.xp6(2),t.Q6J("label","De enlace")("value",e.getIdentifier(e.IdentifierSchemas.issn_l)),t.xp6(5),t.Q6J("label","Impreso")("value",e.getIdentifier(e.IdentifierSchemas.prnps)),t.xp6(2),t.Q6J("label","Electr\xf3nico")("value",e.getIdentifier(e.IdentifierSchemas.ernps)),t.xp6(2),t.Q6J("label","URL")("value",e.getIdentifier(e.IdentifierSchemas.url)),t.xp6(6),t.Q6J("sourceData",e.source.data)("editable",!1)("ngStyle",t.DdM(18,Ye))}}function Ke(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Le,2,2,"catalog-source-view-version-info",10),t.YNc(2,Be,30,19,"mat-card",11),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngSwitchCase",e.sourceType.JOURNAL.value)}}function Ge(n,r){if(1&n&&(t.ynx(0,8),t.YNc(1,Ke,3,1,"ng-container",9),t.BQk()),2&n){const e=t.oxw();t.Q6J("ngSwitch",e.source.data.source_type),t.xp6(1),t.Q6J("ngIf",e.source)}}const He=function(){return{width:"100%",height:"auto",padding:"16px","min-height":"56px"}};let Xe=(()=>{class n{constructor(e,i,o,s,l){this.route=e,this._router=i,this._snackBar=o,this.dialog=s,this._sourceService=l,this.sourceType=a.rRR,this.IdentifierSchemas=a.dK2,this.dialogCommentText="",this.saving=!1,this.source_type_label=a.rRR.JOURNAL.label}ngOnInit(){this.route.data.subscribe({next:e=>{if(e.source&&e.source.metadata){let o,i=e.source.metadata;i.source_type===this.sourceType.JOURNAL.value?(o=new a.tjp,o.deepcopy(i),this.source=new a.ULI,this.source.data.deepcopy(o),this.source.source_uuid=e.source.id,console.log(this.source)):(o=new a.MMO,o.deepcopy(i),this.source=new a.Iv4,this.source.id=e.source.id,this.source.source_uuid=e.source.id,this.source.data.deepcopy(o),this.source.data.id=e.source.id,this.source_type_label=i.source_type==this.sourceType.REPOSITORY.value?this.sourceType.REPOSITORY.label:this.sourceType.OTHER.label)}else new a.pF$(this._snackBar).showMessage(a.GL1.serverError,e.toString())},error:e=>{console.log("error: "+e+".")},complete:()=>{console.log("complete")}})}getIdentifier(e){return this.source?this.source.data.getIdentifierValue(e):""}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.gz),t.Y36(h.F0),t.Y36(C.ux),t.Y36(g.uw),t.Y36(a.tkg))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-view-read"]],decls:4,vars:5,consts:[[3,"loading"],["fxLayout","row wrap","fxLayoutAlign","space-between center",3,"ngStyle"],["fxLayout","column wrap","style","padding: 0px 16px;white-space: normal;",4,"ngIf"],[3,"ngSwitch",4,"ngIf"],["fxLayout","column wrap",2,"padding","0px 16px","white-space","normal"],[1,"mat-headline-6"],["color","primary",1,"mat-caption"],[1,"mat-caption"],[3,"ngSwitch"],[4,"ngIf"],[3,"sourceVersion","showVersionLabel",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"sourceVersion","showVersionLabel"],["view",""],[3,"label","value"],[3,"label","value",4,"ngIf"],[2,"font-weight","bold"],[2,"margin-left","0.8em"],[2,"margin","1em","background-color","whitesmoke"],[3,"sourceData","editable","ngStyle"]],template:function(i,o){1&i&&(t._UZ(0,"toco-progress",0),t.TgZ(1,"mat-toolbar",1),t.YNc(2,ke,7,3,"div",2),t.qZA(),t.YNc(3,Ge,2,2,"ng-container",3)),2&i&&(t.Q6J("loading",o.saving),t.xp6(1),t.Q6J("ngStyle",t.DdM(4,He)),t.xp6(1),t.Q6J("ngIf",o.source),t.xp6(1),t.Q6J("ngIf",o.source))},dependencies:[d.O5,d.PC,d.RF,d.n9,d.ED,T.Ye,_.a8,_.dn,_.dk,_.n5,J.hX,a.t15,p.xw,p.Wh,w.Zl,Q,rt,et]})}return n})();var U=c(2096);class We{static getTopOrganization(r,e){return localStorage.getItem("topMainOrganization")&&""!=localStorage.getItem("topMainOrganization")?JSON.parse(localStorage.getItem("topMainOrganization")):(e.topOrganizationPID&&r.getOrganizationByPID(e.topOrganizationPID).subscribe(i=>i,i=>{console.log("error")},()=>{}),null)}}function $e(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.currentJournal.data.title," ")}}function tn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function en(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"T\xedtulo:"),t.qZA(),t.YNc(3,$e,2,1,"mat-label",5),t.YNc(4,tn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.title),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.title)}}function nn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.currentJournal.data.subtitle," ")}}function an(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function on(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Subt\xedtulo:"),t.qZA(),t.YNc(3,nn,2,1,"mat-label",5),t.YNc(4,an,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.subtitle),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.subtitle)}}function rn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.currentJournal.data.shortname," ")}}function sn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function ln(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Nombre Abreviado:"),t.qZA(),t.YNc(3,rn,2,1,"mat-label",5),t.YNc(4,sn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.shortname),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.shortname)}}function cn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.tipos[e.currentJournal.data.source_type].label," ")}}function un(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function dn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Tipo:"),t.qZA(),t.YNc(3,cn,2,1,"mat-label",5),t.YNc(4,un,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.source_type),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.source_type)}}function _n(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","Impreso")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.issn_p))}}function gn(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","Electr\xf3nico")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.issn_e))}}function pn(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","De enlace")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.issn_l))}}function mn(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","Impreso")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.prnps))}}function hn(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","Electr\xf3nico")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.ernps))}}function fn(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","URL")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.url))}}function xn(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-source-view-version-info-field",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("label","OAIURL")("value",e.currentJournal.data.getIdentifierValue(e.IdentifierSchemas.oaiurl))}}function vn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.currentJournal.data.email," ")}}function Tn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function wn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Email:"),t.qZA(),t.YNc(3,vn,2,1,"mat-label",5),t.YNc(4,Tn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.email),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.email)}}function Jn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.currentJournal.data.purpose," ")}}function bn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function Cn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Prop\xf3sito:"),t.qZA(),t.YNc(3,Jn,2,1,"mat-label",5),t.YNc(4,bn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.purpose),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.purpose)}}function Sn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,e.currentJournal.data.start_year)," ")}}function yn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function In(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"A\xf1o de Inicio:"),t.qZA(),t.YNc(3,Sn,3,3,"mat-label",5),t.YNc(4,yn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.start_year),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.start_year)}}function Zn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,e.currentJournal.data.end_year)," ")}}function Dn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function An(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"A\xf1o de Fin:"),t.qZA(),t.YNc(3,Zn,3,3,"mat-label",5),t.YNc(4,Dn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.end_year),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.end_year)}}function Vn(n,r){if(1&n&&(t.TgZ(0,"mat-label"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.currentJournal.data.frequency," ")}}function En(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function On(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Frecuencia de Publicaci\xf3n:"),t.qZA(),t.YNc(3,Vn,2,1,"mat-label",5),t.YNc(4,En,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.frequency),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.frequency)}}function Qn(n,r){if(1&n&&(t.TgZ(0,"a",10),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.s9C("href",e.currentJournal.data.seriadas_cubanas,t.LSH),t.xp6(1),t.hij(" ",e.currentJournal.data.seriadas_cubanas," ")}}function Un(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function Nn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Seriadas Cubanas:"),t.qZA(),t.YNc(3,Qn,2,2,"a",9),t.YNc(4,Un,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.seriadas_cubanas),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.seriadas_cubanas)}}function jn(n,r){if(1&n&&(t.TgZ(0,"a",10),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.s9C("href",e.currentJournal.data.socialNetworks.facebook,t.LSH),t.xp6(1),t.hij(" ",e.currentJournal.data.socialNetworks.facebook," ")}}function Fn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function Mn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Facebook:"),t.qZA(),t.YNc(3,jn,2,2,"a",9),t.YNc(4,Fn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.socialNetworks.facebook),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.socialNetworks.facebook)}}function Rn(n,r){if(1&n&&(t.TgZ(0,"a",10),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.s9C("href",e.currentJournal.data.socialNetworks.twitter,t.LSH),t.xp6(1),t.hij(" ",e.currentJournal.data.socialNetworks.twitter," ")}}function Pn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function qn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Twitter:"),t.qZA(),t.YNc(3,Rn,2,2,"a",9),t.YNc(4,Pn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.socialNetworks.twitter),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.socialNetworks.twitter)}}function kn(n,r){if(1&n&&(t.TgZ(0,"a",10),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.s9C("href",e.currentJournal.data.socialNetworks.linkedin,t.LSH),t.xp6(1),t.hij(" ",e.currentJournal.data.socialNetworks.linkedin," ")}}function Ln(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function zn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Linkedin:"),t.qZA(),t.YNc(3,kn,2,2,"a",9),t.YNc(4,Ln,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.currentJournal.data.socialNetworks.linkedin),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.data.socialNetworks.linkedin)}}function Yn(n,r){1&n&&(t.TgZ(0,"mat-label",7),t._uU(1,"Vac\xedo"),t.qZA())}function Bn(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-label",4),t._uU(2,"Descripci\xf3n:"),t.qZA(),t.YNc(3,Yn,2,0,"mat-label",6),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",!e.currentJournal.data.description)}}let Kn=(()=>{class n{constructor(){this.editingJournalChange=new t.vpe,this.journalDataType=a.IQt,this.IdentifierSchemas=a.dK2,this.tipos=a.rRR}ngOnInit(){null==this.editingJournal.data&&(this.editingJournal.data=new a.tjp),null==this.currentJournal.data&&(this.currentJournal.data=new a.tjp),null==this.type&&(this.type=a.IQt.default)}replace(e,i=!1){switch(e){case a.IQt.description:i?this.editingJournal.data.description+=" "+this.currentJournal.data.description:this.editingJournal.data.description=this.currentJournal.data.description;break;case a.IQt.email:i?this.editingJournal.data.email+=" "+this.currentJournal.data.email:this.editingJournal.data.email=this.currentJournal.data.email;break;case a.IQt.end_year:i?this.editingJournal.data.end_year+=" "+this.currentJournal.data.end_year:this.editingJournal.data.end_year=this.currentJournal.data.end_year;break;case a.IQt.facebook:i?this.editingJournal.data.socialNetworks.facebook+=" "+this.currentJournal.data.socialNetworks.facebook:this.editingJournal.data.socialNetworks.facebook=this.currentJournal.data.socialNetworks.facebook;break;case a.IQt.frequency:i?this.editingJournal.data.frequency+=" "+this.currentJournal.data.frequency:this.editingJournal.data.frequency=this.currentJournal.data.frequency;break;case a.IQt.issnP:this.editingJournal.data.setIdentifierValue(a.dK2.issn_p,i?this.editingJournal.data.getIdentifierValue(a.dK2.issn_p)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.issn_p):this.currentJournal.data.getIdentifierValue(a.dK2.issn_p));break;case a.IQt.issnE:this.editingJournal.data.setIdentifierValue(a.dK2.issn_e,i?this.editingJournal.data.getIdentifierValue(a.dK2.issn_e)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.issn_e):this.currentJournal.data.getIdentifierValue(a.dK2.issn_e));break;case a.IQt.issnL:this.editingJournal.data.setIdentifierValue(a.dK2.issn_l,i?this.editingJournal.data.getIdentifierValue(a.dK2.issn_l)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.issn_l):this.currentJournal.data.getIdentifierValue(a.dK2.issn_l));break;case a.IQt.rnpsP:this.editingJournal.data.setIdentifierValue(a.dK2.prnps,i?this.editingJournal.data.getIdentifierValue(a.dK2.prnps)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.prnps):this.currentJournal.data.getIdentifierValue(a.dK2.prnps));break;case a.IQt.rnpsE:this.editingJournal.data.setIdentifierValue(a.dK2.ernps,i?this.editingJournal.data.getIdentifierValue(a.dK2.ernps)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.ernps):this.currentJournal.data.getIdentifierValue(a.dK2.ernps));break;case a.IQt.end_year:i?this.editingJournal.data.end_year+=" "+this.currentJournal.data.end_year:this.editingJournal.data.end_year=this.currentJournal.data.end_year;break;case a.IQt.linkedin:i?this.editingJournal.data.socialNetworks.linkedin+=" "+this.currentJournal.data.socialNetworks.linkedin:this.editingJournal.data.socialNetworks.linkedin=this.currentJournal.data.socialNetworks.linkedin;break;case a.IQt.logo:i?this.editingJournal.data.logo+=" "+this.currentJournal.data.logo:this.editingJournal.data.logo=this.currentJournal.data.logo;break;case a.IQt.purpose:i?this.editingJournal.data.purpose+=" "+this.currentJournal.data.purpose:this.editingJournal.data.purpose=this.currentJournal.data.purpose;break;case a.IQt.seriadas_cubanas:i?this.editingJournal.data.seriadas_cubanas+=" "+this.currentJournal.data.seriadas_cubanas:this.editingJournal.data.seriadas_cubanas=this.currentJournal.data.seriadas_cubanas;break;case a.IQt.shortname:i?this.editingJournal.data.shortname+=" "+this.currentJournal.data.shortname:this.editingJournal.data.shortname=this.currentJournal.data.shortname;break;case a.IQt.start_year:i?this.editingJournal.data.start_year+=" "+this.currentJournal.data.start_year:this.editingJournal.data.start_year=this.currentJournal.data.start_year;break;case a.IQt.subtitle:i?this.editingJournal.data.subtitle+=" "+this.currentJournal.data.subtitle:this.editingJournal.data.subtitle=this.currentJournal.data.subtitle;break;case a.IQt.title:i?this.editingJournal.data.title+=" "+this.currentJournal.data.title:this.editingJournal.data.title=this.currentJournal.data.title;break;case a.IQt.twitter:i?this.editingJournal.data.socialNetworks.twitter+=" "+this.currentJournal.data.socialNetworks.twitter:this.editingJournal.data.socialNetworks.twitter=this.currentJournal.data.socialNetworks.twitter;break;case a.IQt.url:this.editingJournal.data.setIdentifierValue(a.dK2.url,i?this.editingJournal.data.getIdentifierValue(a.dK2.url)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.url):this.currentJournal.data.getIdentifierValue(a.dK2.url));break;case a.IQt.oaiurl:this.editingJournal.data.setIdentifierValue(a.dK2.oaiurl,i?this.editingJournal.data.getIdentifierValue(a.dK2.oaiurl)+" "+this.currentJournal.data.getIdentifierValue(a.dK2.oaiurl):this.currentJournal.data.getIdentifierValue(a.dK2.oaiurl));break;case a.IQt.source_type:i?this.editingJournal.data.source_type+=" "+this.currentJournal.data.source_type:this.editingJournal.data.source_type=this.currentJournal.data.source_type}this.editingJournalChange.emit(this.editingJournal)}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-journal-view-version-field"]],inputs:{editingJournal:"editingJournal",currentJournal:"currentJournal",type:"type"},outputs:{editingJournalChange:"editingJournalChange"},decls:26,vars:22,consts:[["mat-icon-button","","aria-label","Next version","matTooltip","Remplazar",3,"click"],["color","warn"],[3,"ngSwitch"],[4,"ngSwitchCase"],[2,"font-weight","bold"],[4,"ngIf"],["class","text-muted text-through",4,"ngIf"],[1,"text-muted","text-through"],[3,"label","value"],["target","_blanck",3,"href",4,"ngIf"],["target","_blanck",3,"href"]],template:function(i,o){1&i&&(t.TgZ(0,"div")(1,"button",0),t.NdJ("click",function(){return o.replace(o.type)}),t.TgZ(2,"mat-icon",1),t._uU(3,"layers"),t.qZA()(),t.ynx(4,2),t.YNc(5,en,5,2,"ng-container",3),t.YNc(6,on,5,2,"ng-container",3),t.YNc(7,ln,5,2,"ng-container",3),t.YNc(8,dn,5,2,"ng-container",3),t.YNc(9,_n,2,2,"ng-container",3),t.YNc(10,gn,2,2,"ng-container",3),t.YNc(11,pn,2,2,"ng-container",3),t.YNc(12,mn,2,2,"ng-container",3),t.YNc(13,hn,2,2,"ng-container",3),t.YNc(14,fn,2,2,"ng-container",3),t.YNc(15,xn,2,2,"ng-container",3),t.YNc(16,wn,5,2,"ng-container",3),t.YNc(17,Cn,5,2,"ng-container",3),t.YNc(18,In,5,2,"ng-container",3),t.YNc(19,An,5,2,"ng-container",3),t.YNc(20,On,5,2,"ng-container",3),t.YNc(21,Nn,5,2,"ng-container",3),t.YNc(22,Mn,5,2,"ng-container",3),t.YNc(23,qn,5,2,"ng-container",3),t.YNc(24,zn,5,2,"ng-container",3),t.YNc(25,Bn,4,1,"ng-container",3),t.BQk(),t.qZA()),2&i&&(t.xp6(4),t.Q6J("ngSwitch",o.type),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.title),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.subtitle),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.shortname),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.source_type),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.issnP),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.issnE),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.issnL),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.rnpsP),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.rnpsE),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.url),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.oaiurl),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.email),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.purpose),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.start_year),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.end_year),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.frequency),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.seriadas_cubanas),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.facebook),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.twitter),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.linkedin),t.xp6(1),t.Q6J("ngSwitchCase",o.journalDataType.description))},dependencies:[d.O5,d.RF,d.n9,f.RK,I.gM,S.Hw,J.hX,et,d.uU],styles:[".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}"]})}return n})();function Gn(n,r){if(1&n&&(t.TgZ(0,"mat-icon",17),t._uU(1,"star"),t.qZA()),2&n){const e=t.oxw(2);t.s9C("matTooltip",e.currentJournal.comment)}}function Hn(n,r){if(1&n&&(t.TgZ(0,"mat-icon",17),t.ALo(1,"date"),t._uU(2,"adjust"),t.qZA()),2&n){const e=t.oxw(2);t.hYB("matTooltip","",t.lcZ(1,2,e.currentJournal.created_at),". ",e.currentJournal.userprofile.identify(),"")}}function Xn(n,r){if(1&n&&t._UZ(0,"div",18),2&n){const e=t.oxw(2);t.Q6J("innerHTML",e.currentJournal.data.description,t.oJD)}}function Wn(n,r){1&n&&(t.TgZ(0,"mat-label",19),t._uU(1,"Vac\xedo"),t.qZA())}function $n(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-chip-option")(2,"button",20),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.concat(l.journalDataType.term,s))}),t.TgZ(3,"mat-icon",14),t._uU(4,"merge_type"),t.qZA()(),t._uU(5),t.qZA(),t.BQk()}if(2&n){const e=r.$implicit;t.xp6(5),t.hij(" ",e.description," ")}}function ti(n,r){1&n&&(t.TgZ(0,"mat-label",19),t._uU(1,"Vac\xedo"),t.qZA())}function ei(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"mat-chip"),t._uU(2),t.qZA(),t.BQk()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",e.description," ")}}const ht=function(){return{margin:"1em"}};function ni(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title")(3,"div",2),t.YNc(4,Gn,2,1,"mat-icon",3),t.YNc(5,Hn,3,4,"mat-icon",3),t.qZA()(),t.TgZ(6,"mat-card-subtitle")(7,"mat-label"),t._uU(8),t.qZA()()(),t._UZ(9,"mat-divider",4),t.TgZ(10,"mat-card-content")(11,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(12,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(13,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(14,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(15,"mat-label",6),t._uU(16,"ISSN: "),t.qZA(),t.TgZ(17,"div",7)(18,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(19,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(20,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA()(),t.TgZ(21,"mat-label",6),t._uU(22,"RNPS: "),t.qZA(),t.TgZ(23,"div",7)(24,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(25,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA()(),t.TgZ(26,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(27,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(28,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(29,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(30,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(31,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(32,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(33,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(34,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.YNc(35,Xn,1,1,"div",8),t.TgZ(36,"mat-label",6),t._uU(37,"Redes Sociales:"),t.qZA(),t.TgZ(38,"div",7)(39,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(40,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA(),t.TgZ(41,"catalog-journal-view-version-field",5),t.NdJ("editingJournalChange",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.fieldEditingJournalChange())}),t.qZA()(),t._UZ(42,"mat-divider",9),t.TgZ(43,"mat-card",10)(44,"mat-card-header")(45,"mat-card-title"),t._uU(46," Licencia: "),t.qZA(),t.YNc(47,Wn,2,0,"mat-label",11),t.qZA(),t.TgZ(48,"mat-card-content")(49,"mat-chip-listbox"),t.YNc(50,$n,6,1,"ng-container",12),t.qZA()()(),t.TgZ(51,"mat-card",10)(52,"mat-card-header")(53,"mat-card-title")(54,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.replaceSubjects())}),t.TgZ(55,"mat-icon",14),t._uU(56,"merge_type"),t.qZA()(),t._uU(57," Materias: "),t.qZA(),t.YNc(58,ti,2,0,"mat-label",11),t.qZA(),t.TgZ(59,"mat-card-content")(60,"mat-chip-listbox"),t.YNc(61,ei,3,1,"ng-container",12),t.qZA()()(),t.TgZ(62,"mat-card",10)(63,"mat-card-header")(64,"mat-card-title")(65,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.replaceOrganizations())}),t.TgZ(66,"mat-icon",14),t._uU(67,"merge_type"),t.qZA()(),t._uU(68," Organizaciones: "),t.qZA()(),t.TgZ(69,"mat-card-content"),t._UZ(70,"catalog-source-edit-organizations",15),t.qZA()(),t.TgZ(71,"mat-card",10)(72,"mat-card-header")(73,"mat-card-title")(74,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.replaceIndexes())}),t.TgZ(75,"mat-icon",14),t._uU(76,"merge_type"),t.qZA()(),t._uU(77," Indizaciones: "),t.qZA()(),t.TgZ(78,"mat-card-content"),t._UZ(79,"catalog-source-edit-indexes",15),t.qZA()()(),t._UZ(80,"mat-divider",16),t.qZA()}if(2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.currentJournal.is_current),t.xp6(1),t.Q6J("ngIf",!e.currentJournal.reviewed),t.xp6(3),t.hij(" ",e.currentJournal.comment," "),t.xp6(1),t.Q6J("inset",!0),t.xp6(2),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.title),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.subtitle),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.shortname),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.source_type),t.xp6(4),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.issnP),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.issnE),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.issnL),t.xp6(4),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.rnpsP),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.rnpsE),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.url),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.oaiurl),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.email),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.seriadas_cubanas),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.purpose),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.start_year),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.end_year),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.frequency),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.description),t.xp6(1),t.Q6J("ngIf",e.currentJournal.data.description),t.xp6(4),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.facebook),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.twitter),t.xp6(1),t.Q6J("editingJournal",e.editingJournal)("currentJournal",e.currentJournal)("type",e.journalDataType.linkedin),t.xp6(1),t.Q6J("inset",!0),t.xp6(5),t.Q6J("ngIf",0==e.currentLicenceTerms.length),t.xp6(3),t.Q6J("ngForOf",e.currentLicenceTerms),t.xp6(8),t.Q6J("ngIf",0==e.currentSubjectTerms.length),t.xp6(3),t.Q6J("ngForOf",e.currentSubjectTerms),t.xp6(9),t.Q6J("sourceData",e.currentJournal.data)("editable",!1)("ngStyle",t.DdM(80,ht)),t.xp6(9),t.Q6J("sourceData",e.currentJournal.data)("editable",!1)("ngStyle",t.DdM(81,ht)),t.xp6(1),t.Q6J("inset",!0)}}let ft=(()=>{class n{constructor(e){this._snackBar=e,this.journalDataType=a.IQt,this.panelOpenState=!1,this.currentJournalChecked=!1,this.editingJournalChange=new t.vpe,this.loading=!0}ngOnInit(){null==this.currentJournal&&(this.currentJournal=new a.ULI),this.loadJournalData(),null==this.type&&(this.type=a.IQt.default)}ngOnChanges(){this.loading=!0,this.ngOnInit(),console.log("***//// SourceJournalViewVersionComponent ****////***///",this.currentJournal),this.loading=!1}loadJournalData(){this.currentDataBaseTerms=new Array,this.currentGroupTerms=new Array,this.currentInstitutionTerms=new Array,this.currentLicenceTerms=new Array,this.currentProvinceTerms=new Array,this.currentSubjectTerms=new Array,this.vocabularies=a.r0t,this.currentJournal.data.classifications&&this.currentJournal.data.classifications.forEach(e=>{switch(e.vocabulary.toString()){case a.r0t.CUBAN_INTITUTIONS:this.currentInstitutionTerms.push(e);break;case a.r0t.INDEXES:this.currentDataBaseTerms.push(e);break;case a.r0t.INDEXES_CLASIFICATION:this.currentGroupTerms.push(e);break;case a.r0t.LICENCES:this.currentLicenceTerms.push(e);break;case a.r0t.CUBAN_PROVINCES:this.currentProvinceTerms.push(e);break;case a.r0t.SUBJECTS:this.currentSubjectTerms.push(e)}})}markAsViewed(){this.currentJournalChecked&&(this.currentJournal.data.reviewed=!0,new a.pF$(this._snackBar).showMessage(a.GL1.OK,"Revisi\xf3n marcada como vista!!!"))}fieldEditingJournalChange(){this.editingJournalChange.emit(this.editingJournal)}replace(){this.editingJournal=this.currentJournal,this.editingJournalChange.emit(this.editingJournal),console.log("editingJournal remplazado",this.editingJournal)}concat(e,i){if(e==a.IQt.term){let o=!0;for(let s=0;s<this.editingJournal.data.classifications.length;s++)this.editingJournal.data.classifications[s].id==i.id&&(this.editingJournal.data.classifications[s].data=i.data,o=!1);o&&this.editingJournal.data.classifications.push(i),this.editingJournalChange.emit(this.editingJournal)}}replaceSubjects(){this.replaceClassifications(a.r0t.SUBJECTS)}replaceIndexes(){this.replaceClassifications(a.r0t.INDEXES)}replaceClassifications(e){let o=[];this.editingJournal.data.classifications.forEach(s=>{s.vocabulary!=e&&o.push(s)}),this.currentJournal.data.classifications.forEach(s=>{s.vocabulary==e&&o.push(s)}),this.editingJournal.data.classifications=o,this.editingJournalChange.emit(this.editingJournal)}replaceOrganizations(){let i=[];this.currentJournal.data.organizations.forEach(o=>{i.push(o)}),this.editingJournal.data.organizations=i,this.editingJournalChange.emit(this.editingJournal)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(C.ux))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-journal-view-version"]],viewQuery:function(i,o){if(1&i&&(t.Gf(Q,5),t.Gf(F,5)),2&i){let s;t.iGM(s=t.CRH())&&(o.orgs=s.first),t.iGM(s=t.CRH())&&(o.indexes=s.first)}},inputs:{currentJournal:"currentJournal",type:"type",editingJournal:"editingJournal"},outputs:{editingJournalChange:"editingJournalChange"},features:[t.TTD],decls:2,vars:2,consts:[[3,"loading"],[4,"ngIf"],["fxLAyout","row","fxLayoutAlign","space-between start"],["class","mat-18 notification-position","color","accent",3,"matTooltip",4,"ngIf"],[2,"margin-bottom","1em",3,"inset"],[3,"editingJournal","currentJournal","type","editingJournalChange"],[2,"font-weight","bold"],[2,"margin-left","0.8em"],["class","e2e-inner-html-bound text-align-justify",3,"innerHTML",4,"ngIf"],[2,"margin-bottom","1em","margin-top","1em",3,"inset"],[2,"margin","1em","background-color","whitesmoke"],["class","text-muted text-through",4,"ngIf"],[4,"ngFor","ngForOf"],["mat-icon-button","","color","accent","matTooltip","Reemplazar",3,"click"],[1,"mat-18"],[3,"sourceData","editable","ngStyle"],[3,"inset"],["color","accent",1,"mat-18","notification-position",3,"matTooltip"],[1,"e2e-inner-html-bound","text-align-justify",3,"innerHTML"],[1,"text-muted","text-through"],["mat-icon-button","","color","accent","matTooltip","Agregar",3,"click"]],template:function(i,o){1&i&&(t._UZ(0,"toco-progress",0),t.YNc(1,ni,81,82,"mat-card",1)),2&i&&(t.Q6J("loading",o.loading),t.xp6(1),t.Q6J("ngIf",o.currentJournal.data))},dependencies:[d.sg,d.O5,d.PC,f.RK,I.gM,S.Hw,_.a8,_.dn,_.dk,_.$j,_.n5,J.hX,M.HS,M.z2,M.iO,ot.d,a.t15,p.Wh,w.Zl,F,Q,Kn,d.uU],styles:[".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}"]})}return n})();function ii(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.editVersion=!o.editVersion)}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function ai(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.editVersion=!o.editVersion)}),t.TgZ(1,"mat-icon"),t._uU(2,"visibility"),t.qZA()()}}function oi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.showVersions=!o.showVersions)}),t.TgZ(1,"mat-icon"),t._uU(2,"history"),t.qZA()()}}function ri(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.showVersions=!o.showVersions)}),t.TgZ(1,"mat-icon"),t._uU(2,"history"),t.qZA()()}}function si(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.previousVersion())}),t.TgZ(2,"mat-icon"),t._uU(3,"navigate_before"),t.qZA()(),t.TgZ(4,"button",17),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.nextVersion())}),t.TgZ(5,"mat-icon"),t._uU(6,"navigate_next"),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.isDisabledNavigatePrevious),t.xp6(3),t.Q6J("disabled",e.isDisabledNavigateNext)}}function li(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"catalog-source-edit-journal",20),t.NdJ("journalEditDone",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.sourceEditDone(o))}),t.qZA()}if(2&n){const e=t.oxw(3);t.Q6J("journalVersion",e.editingSource)("showEditHeader",!1)("showFinalStep",!1)("topMainOrganization",e.topMainOrganization)}}function ci(n,r){if(1&n&&t._UZ(0,"catalog-source-view-version-info",21),2&n){const e=t.oxw(3);t.Q6J("sourceVersion",e.editingSource)}}function ui(n,r){if(1&n){const e=t.EpF();t.ynx(0),t._UZ(1,"catalog-source-view-version-info",21,22),t.TgZ(3,"catalog-journal-view-version",23,24),t.NdJ("editingSourceChange",function(){t.CHM(e);const o=t.MAs(2),s=t.oxw(3);return t.KtG(o.editingSourceChange(s.editingSource))}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("sourceVersion",e.editingSource),t.xp6(2),t.Q6J("editingJournal",e.editingSource)("currentJournal",e.selectedSource)}}function di(n,r){if(1&n&&(t.ynx(0),t.YNc(1,li,1,4,"catalog-source-edit-journal",18),t.YNc(2,ci,1,1,"catalog-source-view-version-info",19),t.YNc(3,ui,5,3,"ng-container",11),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.editVersion),t.xp6(1),t.Q6J("ngIf",!e.editVersion&&!e.showVersions),t.xp6(1),t.Q6J("ngIf",!e.editVersion&&e.showVersions)}}function _i(n,r){1&n&&(t.TgZ(0,"mat-card",25)(1,"mat-card-content")(2,"h1"),t._uU(3,"Este componente necesita las revisiones de la revista."),t.qZA()()())}const gi=function(){return{"white-space":"normal"}};function pi(n,r){if(1&n&&(t.TgZ(0,"div",2)(1,"mat-toolbar",3)(2,"mat-toolbar-row",4)(3,"span",5),t._uU(4," Editor de Revisiones "),t.qZA(),t._UZ(5,"mat-divider",6),t.YNc(6,ii,3,0,"button",7),t.YNc(7,ai,3,0,"button",8),t.YNc(8,oi,3,0,"button",9),t.YNc(9,ri,3,0,"button",10),t.YNc(10,si,7,2,"div",11),t.qZA()(),t.YNc(11,di,4,3,"ng-container",11),t.YNc(12,_i,4,0,"mat-card",1),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngStyle",t.DdM(9,gi)),t.xp6(2),t.Q6J("vertical",!0),t.xp6(1),t.Q6J("ngIf",!e.editVersion),t.xp6(1),t.Q6J("ngIf",e.editVersion),t.xp6(1),t.Q6J("ngIf",!e.editVersion&&!e.showVersions),t.xp6(1),t.Q6J("ngIf",!e.editVersion&&e.showVersions),t.xp6(1),t.Q6J("ngIf",!e.editVersion&&e.showVersions),t.xp6(1),t.Q6J("ngIf",null!=e.versions),t.xp6(1),t.Q6J("ngIf",null==e.versions)}}function mi(n,r){1&n&&(t.TgZ(0,"mat-card",25)(1,"mat-card-content")(2,"h1"),t._uU(3,"No se encontr\xf3 la informaci\xf3n solicitada"),t.qZA()()())}let hi=(()=>{class n{constructor(e,i,o,s){this.metadata=e,this.environment=i,this._snackBar=o,this.dialog=s,this.topMainOrganization=null,this.panelOpenState=!1,this.defaultLogo=this.environment.sceibaHost+"static/favicon.ico",this.showVersions=!1,this.editVersion=!1}ngOnInit(){this.isDisabledNavigatePrevious=!0,this.isDisabledNavigateNext=!1,this.vocabularies=a.r0t,this.lengthVersion=this.versions.length,this.selectedVersion=this.getSelectedSourcePosition(),this.SelectSourceVersion(),this.metadata.setStandardMeta("Revista Cient\xedfica "+this.editingSource.data.title,this.editingSource.data.description,"")}nextVersion(){this.selectedVersion<this.lengthVersion-1?(this.isDisabledNavigateNext=!1,this.isDisabledNavigatePrevious=!1,this.selectedVersion++,this.SelectSourceVersion()):(this.isDisabledNavigateNext=!0,new a.pF$(this._snackBar).showMessage(a.GL1.OK,"No hay m\xe1s versiones para mostrar")),this.selectedVersion==this.lengthVersion-1&&(this.isDisabledNavigateNext=!0)}previousVersion(){this.selectedVersion>0?(this.isDisabledNavigatePrevious=!1,this.isDisabledNavigateNext=!1,this.selectedVersion--,this.SelectSourceVersion()):(this.isDisabledNavigatePrevious=!0,new a.pF$(this._snackBar).showMessage(a.GL1.OK,"No hay m\xe1s versiones para mostrar")),0==this.selectedVersion&&(this.isDisabledNavigatePrevious=!0)}SelectSourceVersion(){this.versions.length>=0&&this.selectedVersion>=0&&this.selectedVersion<this.versions.length&&(this.selectedSource=new a.ULI,this.selectedSource.deepcopy(this.versions[this.selectedVersion]),console.log("this.selectedVersion",this.selectedVersion,this.selectedSource))}getSelectedSourcePosition(){let e=0;return this.versions.forEach((i,o)=>{if(null!=i.reviewed&&i.reviewed)return e=o,e}),e}sourceEditDone(e){this.editVersion=!1,console.log("AAaAAAAAAAAAAAAAAAAAA")}toogleShowVersions(){this.showVersions=!this.showVersions,this.editVersion=!1}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(a.Doh),t.Y36(a.qAh),t.Y36(C.ux),t.Y36(g.uw))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-journal-view"]],viewQuery:function(i,o){if(1&i&&t.Gf(ft,5),2&i){let s;t.iGM(s=t.CRH())&&(o.versionComponent=s.first)}},inputs:{topMainOrganization:"topMainOrganization",editingSource:"editingSource",versions:"versions"},decls:2,vars:2,consts:[["fxLayout","row wrap","style","margin: 1em",4,"ngIf"],["style","margin: 1em",4,"ngIf"],["fxLayout","row wrap",2,"margin","1em"],[2,"position","sticky","position","-webkit-sticky","top","0","z-index","1000"],["fxLayoutGap","1em","fxLayoutAlign","end center"],[3,"ngStyle"],[3,"vertical"],["mat-icon-button","","aria-label","Editar la Revisi\xf3n actual","matTooltip","Editar la Revisi\xf3n actual",3,"click",4,"ngIf"],["mat-icon-button","","aria-label","Vista Revisiones","matTooltip","Vista Revisiones",3,"click",4,"ngIf"],["mat-icon-button","","aria-label","Ver Revisiones","matTooltip","Ver Revisiones",3,"click",4,"ngIf"],["mat-icon-button","","aria-label","Ocultar Revisiones","matTooltip","Ocultar Revisiones",3,"click",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","aria-label","Editar la Revisi\xf3n actual","matTooltip","Editar la Revisi\xf3n actual",3,"click"],["mat-icon-button","","aria-label","Vista Revisiones","matTooltip","Vista Revisiones",3,"click"],["mat-icon-button","","aria-label","Ver Revisiones","matTooltip","Ver Revisiones",3,"click"],["mat-icon-button","","aria-label","Ocultar Revisiones","matTooltip","Ocultar Revisiones",3,"click"],["mat-icon-button","","aria-label","Previous version","matTooltip","Revisi\xf3n Anterior",3,"disabled","click"],["mat-icon-button","","aria-label","Next version","matTooltip","Revisi\xf3n Siguiente",3,"disabled","click"],[3,"journalVersion","showEditHeader","showFinalStep","topMainOrganization","journalEditDone",4,"ngIf"],["fxFlex","1 2 calc(15em + 20px)","style","margin: 0.5em",3,"sourceVersion",4,"ngIf"],[3,"journalVersion","showEditHeader","showFinalStep","topMainOrganization","journalEditDone"],["fxFlex","1 2 calc(15em + 20px)",2,"margin","0.5em",3,"sourceVersion"],["journalViewInfo",""],["fxFlex","1 2 calc(15em + 20px)",2,"margin","0.5em",3,"editingJournal","currentJournal","editingSourceChange"],["versionsPanel",""],[2,"margin","1em"]],template:function(i,o){1&i&&(t.YNc(0,pi,13,10,"div",0),t.YNc(1,mi,4,0,"mat-card",1)),2&i&&(t.Q6J("ngIf",null!=o.editingSource),t.xp6(1),t.Q6J("ngIf",null==o.editingSource))},dependencies:[d.O5,d.PC,f.RK,T.Ye,T.rD,I.gM,S.Hw,_.a8,_.dn,ot.d,p.xw,p.SQ,p.Wh,p.yH,w.Zl,mt,ft,rt],styles:[".text-muted[_ngcontent-%COMP%]{color:#0000008a;padding-left:.2em}.text-through[_ngcontent-%COMP%]{text-decoration:line-through}.notification-position[_ngcontent-%COMP%]{position:absolute;top:0;right:0}p[_ngcontent-%COMP%]{padding-top:.8em}.overlay[_ngcontent-%COMP%]{opacity:.4;background:#000;width:100%;height:100%;z-index:10;top:0;left:0;position:fixed}"]})}return n})();var fi=c(2032);function xi(n,r){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._uU(3,"ERROR"),t.qZA()()())}function vi(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.desapprove())}),t._uU(1," Despublicar "),t.qZA()}}function Ti(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.publishEditingVersion())}),t._uU(1," Publicar la revisi\xf3n actual "),t.qZA()}}function wi(n,r){if(1&n&&(t.ynx(0),t._UZ(1,"catalog-journal-view",11,12),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("editingSource",e.editingVersion)("versions",e.versions)("topMainOrganization",e.topMainOrganization)}}const Ji=function(){return{width:"100%",height:"auto",padding:"16px","min-height":"56px"}};function bi(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-toolbar",2)(2,"div",3)(3,"span",4),t._uU(4),t.qZA(),t.TgZ(5,"span",5),t._uU(6),t.qZA(),t.TgZ(7,"span",6),t._uU(8),t.qZA()(),t.TgZ(9,"div",7),t.YNc(10,vi,2,0,"button",8),t.YNc(11,Ti,2,0,"button",8),t.TgZ(12,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.saveEditingVersion())}),t._uU(13," Guardar la revisi\xf3n actual "),t.qZA()()(),t.YNc(14,wi,3,3,"ng-container",1),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.DdM(7,Ji)),t.xp6(3),t.hij(" ",e.editingVersion.data.name,""),t.xp6(2),t.hij(" SceibaID: ",e.editingVersion.source_uuid," "),t.xp6(2),t.hij(" Tipo: Fuente - ",e.source_type_label," "),t.xp6(2),t.Q6J("ngIf",e.can_publish()&&e.is_approved()),t.xp6(1),t.Q6J("ngIf",e.can_publish()),t.xp6(3),t.Q6J("ngIf",e.editingVersion&&e.versions)}}function Ci(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"h1",4),t._uU(2,"Guardar cambios"),t.qZA(),t.TgZ(3,"div",5)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Comentario sobre esta revisi\xf3n"),t.qZA(),t.TgZ(7,"textarea",6),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.data.comment=o)}),t._uU(8," "),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("ngModel",e.data.comment)}}function Si(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"h1",4),t._uU(2,"Guardar cambios y publicar"),t.qZA(),t.TgZ(3,"div",5)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Comentario sobre esta revisi\xf3n"),t.qZA(),t.TgZ(7,"textarea",6),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.data.comment=o)}),t._uU(8," "),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("ngModel",e.data.comment)}}function yi(n,r){1&n&&(t.ynx(0),t.TgZ(1,"h1",4),t._uU(2,"Este elemento no ser\xe1 m\xe1s p\xfablico"),t.qZA(),t._UZ(3,"div",5),t.BQk())}let Ii=(()=>{class n{constructor(e,i,o,s,l,m,v){this.route=e,this._router=i,this._snackBar=o,this.dialog=s,this._sourceService=l,this.orgService=m,this.environment=v,this.sourceType=a.rRR,this.topOrganizationPID=null,this.topMainOrganization=null,this.dialogCommentText="",this.loading=!0,this.allows="",this.error=!1,this.source_type_label=a.rRR.JOURNAL.label}ngOnInit(){this.topMainOrganization=We.getTopOrganization(this.orgService,this.environment),this.route.data.subscribe({next:e=>{console.log("VIEW SOURCE"),console.log(e);let i=e.source.data.source.record;this.allows=e.source.data.source.allows;try{this.init(i.id,i.metadata)}catch{new a.pF$(this._snackBar).showMessage(a.GL1.serverError,e.toString())}},error:e=>{console.log("error: "+e+"."),console.log("bbb")},complete:()=>{console.log("complete")}})}_init_source_relations(e){let i=new Array;e.data.organizations&&e.data.organizations.forEach(s=>{let l=new a.wR4;l.deepcopy(s),i.push(l)}),e.data.organizations=i;let o=new Array;e.data.classifications&&e.data.classifications.forEach(s=>{let l=new a.CBV;l.deepcopy(s),o.push(l)}),e.data.classifications=o}init(e,i){i.source_type===this.sourceType.JOURNAL.value?(this.editingVersion=new a.ULI,this.editingVersion.source_uuid=e,this.editingVersion.data.deepcopy(i)):(this.editingVersion=new a.Iv4,this.editingVersion.source_uuid=e,this.editingVersion.data.deepcopy(i)),this.source_type_label=this.get_source_type_label(),this._init_source_relations(this.editingVersion),this._sourceService.getSourceVersions(this.editingVersion.source_uuid).subscribe({next:o=>{if(console.log(o),o.status==a.Mxn.SUCCESS){this.versions=o.data.versions;for(let s=0;s<this.versions.length;s++)this._init_source_relations(this.versions[s]);this.loading=!1}},error:o=>{console.log("error")},complete:()=>{}})}saveEditingVersion(){const e=this.dialog.open(st,{data:{comment:this.dialogCommentText,accept:!1,edit:!0}});console.log(this.editingVersion),e.afterClosed().subscribe(i=>{console.log("The dialog was closed"),console.log(e.getState()),console.log(i),i&&i.accept&&(this.dialogCommentText=i.comment,this.editingVersion.comment=this.dialogCommentText,this.loading=!0,this._sourceService.editSource(this.editingVersion,this.editingVersion.source_uuid).subscribe(o=>{console.log(o);const s=new a.pF$(null,this.dialog);o.status==a.Mxn.SUCCESS&&o.data.source_version.data?(s.showMessage(a.GL1.OK,"Guardada con la revisi\xf3n < "+this.editingVersion.comment+">",a.PWx.dialog,"\xc9xito"),this.editingVersion=null,this.versions=null,this.init(o.data.source_version.source_uuid,o.data.source_version.data)):s.showMessage(a.GL1.serverError,o.message,a.PWx.dialog,"ERROR")},o=>(console.log(o),(0,U.of)(null)),()=>{}))},i=>(console.log(i),(0,U.of)(null)),()=>{})}publishEditingVersion(){const e=this.dialog.open(st,{data:{comment:this.dialogCommentText,accept:!1,publish:!0}});console.log(this.editingVersion),e.afterClosed().subscribe({next:i=>{console.log("The dialog was closed"),console.log(e.getState()),console.log(i),i&&i.accept&&(this.dialogCommentText=i.comment,this.editingVersion.comment=this.dialogCommentText,this.loading=!0,console.log(this.editingVersion),this._sourceService.makeSourceAsApproved(this.editingVersion,this.editingVersion.source_uuid).subscribe({next:o=>{console.log(o),this.loading=!1;const s=new a.pF$(null,this.dialog);o.status==a.Mxn.SUCCESS&&o.data.source?(s.showMessage(a.GL1.OK,"La revisi\xf3n actual de <"+this.editingVersion.data.title+"> ha sido publicada con \xe9xito",a.PWx.dialog,"\xc9xito"),this._router.navigate([this._router.url])):s.showMessage(a.GL1.serverError,o.message,a.PWx.dialog,"ERROR")},error:o=>(console.log(o),(0,U.of)(null)),complete:()=>{}}))},error:i=>(console.log(i),(0,U.of)(null)),complete:()=>{}})}desapprove(){const e=this.dialog.open(st,{data:{comment:this.dialogCommentText,accept:!1,unpublish:!0}});console.log(this.editingVersion),e.afterClosed().subscribe(i=>{console.log("The dialog was closed"),console.log(e.getState()),console.log(i),this.loading=!0,i&&i.accept&&this._sourceService.makeSourceAsUnApproved(this.editingVersion,this.editingVersion.source_uuid).subscribe(o=>{console.log(o);const s=new a.pF$(null,this.dialog);this.loading=!1,o.status==a.Mxn.SUCCESS&&o.data.source?(s.showMessage(a.GL1.OK,this.editingVersion.data.title+" ya no est\xe1 p\xfablica.",a.PWx.dialog,"\xc9xito"),this.ngOnInit(),this._router.navigate(["sources"])):s.showMessage(a.GL1.serverError,o.message,a.PWx.dialog,"ERROR")},o=>(console.log(o),(0,U.of)(null)),()=>{})},i=>(console.log(i),(0,U.of)(null)),()=>{})}is_approved(){return this.editingVersion.data.source_status==a.aFH.APPROVED.value}can_publish(){return"publish"==this.allows}get_source_type_label(){switch(this.editingVersion.data.source_type){case a.rRR.JOURNAL.value:return a.rRR.JOURNAL.label;case a.rRR.REPOSITORY.value:return a.rRR.REPOSITORY.label;default:return a.rRR.OTHER.label}}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.gz),t.Y36(h.F0),t.Y36(C.ux),t.Y36(g.uw),t.Y36(a.tkg),t.Y36(a.eY8),t.Y36(a.qAh))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-source-view"]],decls:3,vars:3,consts:[[3,"loading"],[4,"ngIf"],["fxLayout","row wrap","fxLayoutAlign","space-between center",3,"ngStyle"],["fxLayout","column wrap"],[1,"mat-headline-6"],["color","primary",1,"mat-caption"],[1,"mat-caption"],["fxLayout","row wrap","fxLayoutGap","20px"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","","color","warn",3,"click"],["mat-stroked-button","","color","primary",3,"click"],[3,"editingSource","versions","topMainOrganization"],["view",""]],template:function(i,o){1&i&&(t._UZ(0,"toco-progress",0),t.YNc(1,xi,4,0,"mat-card",1),t.YNc(2,bi,15,8,"ng-container",1)),2&i&&(t.Q6J("loading",o.loading),t.xp6(1),t.Q6J("ngIf",o.error),t.xp6(1),t.Q6J("ngIf",!o.loading&&!o.error&&o.editingVersion))},dependencies:[d.O5,d.PC,f.lW,T.Ye,_.a8,_.dk,_.n5,a.t15,p.xw,p.SQ,p.Wh,w.Zl,hi]})}return n})(),st=(()=>{class n{constructor(e,i){this.dialogRef=e,this.data=i}onNoClick(){this.data.accept=!1,this.dialogRef.close()}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(g.so),t.Y36(g.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["catalog-journal-view-save-dialog"]],decls:8,vars:4,consts:[[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close","click"],["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"]],template:function(i,o){1&i&&(t.YNc(0,Ci,9,1,"ng-container",0),t.YNc(1,Si,9,1,"ng-container",0),t.YNc(2,yi,4,0,"ng-container",0),t.TgZ(3,"div",1)(4,"button",2),t.NdJ("click",function(){return o.onNoClick()}),t._uU(5,"Cancelar"),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return o.data.accept=!0}),t._uU(7," Guardar "),t.qZA()()),2&i&&(t.Q6J("ngIf",o.data.edit),t.xp6(1),t.Q6J("ngIf",o.data.publish),t.xp6(1),t.Q6J("ngIf",o.data.unpublish),t.xp6(4),t.Q6J("mat-dialog-close",o.data))},dependencies:[d.O5,f.lW,fi.Nt,J.KE,J.hX,g.ZT,g.uh,g.xY,g.H8,x.Fj,x.JJ,x.On],encapsulation:2})}return n})();const Zi=[{path:"",component:fe},{path:"new",children:[{path:"journal",component:Pe}]},{path:":uuid",component:Xe,canActivate:[Te],resolve:{source:j.M}},{path:":uuid/view",component:Ii,canActivate:[ve],resolve:{source:j.U}}];let Di=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(Zi),h.Bz]})}return n})();function xt(n){return new L.w(n,"./assets/i18n/",".json")}let Ai=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[d.ez,Di,Y.m,a.IR2,a.pNY,a.TY2,x.u5,k.o9,a.nzq,z.C,N.JP.forRoot({loader:D.eN}),A.aw.forChild({loader:{provide:A.Zw,useFactory:xt,deps:[D.eN]}})]})}return n})();t.B6R(ut,function(){return[d.O5,et]},[]),t.B6R(dt,function(){return[d.O5,J.hX,et]},function(){return[d.uU]})},8341:(vt,q,c)=>{c.d(q,{m:()=>it});var d=c(1088),D=c(4630),k=c(9014),x=c(2296),A=c(9488),L=c(5195),N=c(5986),z=c(2557),a=c(3680),Y=c(8034),h=c(7700),j=c(6385),b=c(3305),g=c(4170),V=c(3176),E=c(617),t=c(2032),B=c(9038),u=c(7988),K=c(1476),C=c(6007),f=c(5940),T=c(8525),I=c(2651),S=c(2599),G=c(6890),p=c(3566),w=c(8257),_=c(5313),H=c(4104),X=c(1274),W=c(2596),$=c(8445),tt=c(5879);let it=(()=>{class O{static#t=this.\u0275fac=function(at){return new(at||O)};static#e=this.\u0275mod=tt.oAB({type:O});static#n=this.\u0275inj=tt.cJS({imports:[d.xu,x.ot,A.vV,u.Tx,X.g0,W.AV,E.Ps,L.QW,t.c,N.p9,g.lN,h.Is,V.N6,G.ZX,C.Cv,f.Cq,I.SJ,H.Nh,z.Hi,_.p0,p.JX,K.TU,S.rP,T.LD,a.Ng,D.Bb,b.To,Y.FA,a.XK,B.ie,$.dp,k.g,w.T5,a.si,j.t,d.xu,x.ot,A.vV,u.Tx,X.g0,W.AV,E.Ps,L.QW,t.c,N.p9,g.lN,h.Is,V.N6,G.ZX,f.Cq,C.Cv,I.SJ,H.Nh,z.Hi,_.p0,p.JX,K.TU,S.rP,T.LD,a.Ng,D.Bb,b.To,Y.FA,a.XK,B.ie,$.dp,k.g,w.T5,a.si,j.t]})}return O})()}}]);