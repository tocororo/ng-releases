"use strict";(self.webpackChunksceiba_ui=self.webpackChunksceiba_ui||[]).push([[439],{5439:(he,f,o)=>{o.r(f),o.d(f,{RecordSearchModule:()=>ge});var l=o(6814),h=o(3887),p=o(2787),d=o(6825),y=o(9862),e=o(5879),m=o(2651),S=o(7700),A=o(2296),C=o(2596),v=o(617),x=o(5195),b=o(1476),w=o(1994),E=o(2066);function L(a,r){if(1&a&&(e.TgZ(0,"p",10),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.metadata.description," ")}}function T(a,r){1&a&&(e.ynx(0),e._uU(1," | "),e.BQk())}function q(a,r){if(1&a&&(e.TgZ(0,"li",13),e._uU(1),e.YNc(2,T,2,0,"ng-container",14),e.qZA()),2&a){const t=r.$implicit,i=r.index,s=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",i<s.metadata.creators.length-1)}}function Z(a,r){if(1&a&&(e.TgZ(0,"ul",11)(1,"span"),e._uU(2,"Autores:"),e.qZA(),e.YNc(3,q,3,2,"li",12),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngForOf",t.metadata.creators)}}function I(a,r){if(1&a&&(e.TgZ(0,"span",10),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij("Revista: ",t.metadata.source.name,"")}}function k(a,r){if(1&a&&(e.TgZ(0,"span",10),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij("Fecha de publicaci\xf3n: ",t.metadata.publication_date,"")}}function P(a,r){1&a&&e._UZ(0,"hr",15)}const J=function(){return{margin:"1em 8px"}},R=function(a,r){return[a,r]};function N(a,r){if(1&a&&(e.TgZ(0,"div",3)(1,"h2",4)(2,"a",5),e._uU(3),e.qZA()(),e.TgZ(4,"span",6),e._uU(5),e.qZA(),e.YNc(6,L,2,1,"p",7),e.YNc(7,Z,4,1,"ul",8),e.YNc(8,I,2,1,"span",7),e.YNc(9,k,2,1,"span",7),e.YNc(10,P,1,0,"hr",9),e.qZA()),2&a){const t=r.$implicit,i=r.index,s=e.oxw(2);e.Q6J("ngStyle",e.DdM(9,J)),e.xp6(2),e.Q6J("routerLink",e.WLB(10,R,s.env.discover,t.id)),e.xp6(1),e.Oqu(t.metadata.title),e.xp6(2),e.hij(" SceibaID: ",t.metadata.id," "),e.xp6(1),e.Q6J("ngIf",t.metadata.description),e.xp6(1),e.Q6J("ngIf",t.metadata.creators&&t.metadata.creators.length>0),e.xp6(1),e.Q6J("ngIf",t.metadata.source),e.xp6(1),e.Q6J("ngIf",t.metadata.publication_date),e.xp6(1),e.Q6J("ngIf",i<s.hitList.hits.length-1)}}function z(a,r){if(1&a&&(e.TgZ(0,"mat-card")(1,"mat-card-content"),e.YNc(2,N,11,13,"div",2),e.qZA()()),2&a){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.hitList.hits)}}function O(a,r){1&a&&(e.TgZ(0,"mat-card")(1,"mat-card-content")(2,"h2"),e._uU(3,"No hay resultados para su b\xfasqueda..."),e.qZA()()())}let F=(()=>{class a{constructor(t,i,s){this.activatedRoute=t,this.router=i,this._env=s,this.recordsPath="",this.pageSize=5,this.pageIndex=0,this.pageSizeOptions=[5,15,25,50,100],this.query="",this.aggrsSelection={},this.env=this._env}ngOnInit(){console.log(this.hitList),this.query="",this.activatedRoute.queryParamMap.subscribe({next:t=>{this.aggrsSelection={};for(let i=0;i<t.keys.length;i++){const s=t.keys[i];switch(s){case"size":this.pageSize=Number.parseInt(t.get(s));break;case"page":this.pageIndex=Number.parseInt(t.get(s));break;case"q":this.query=t.get(s);break;default:this.aggrsSelection.hasOwnProperty(s)||(this.aggrsSelection[s]=[]),this.aggrsSelection[s].push(t.get(s))}}this.updateFetchParams()},error:t=>{},complete:()=>{}})}updateFetchParams(){this.params=new y.LE,this.params=this.params.set("size",this.pageSize.toString(10)),this.params=this.params.set("page",(this.pageIndex+1).toString(10)),this.params=this.params.set("q",this.query);for(const t in this.aggrsSelection)this.aggrsSelection[t].forEach(i=>{this.params=this.params.set(t,i)})}updateQueryParams(){this.queryParams={},this.queryParams.size=this.pageSize.toString(10),this.queryParams.page=this.pageIndex.toString(10),this.queryParams.q=this.query;for(const t in this.aggrsSelection)this.aggrsSelection[t].forEach(i=>{this.queryParams[t]=i});this.navigationExtras={relativeTo:this.activatedRoute,queryParams:this.queryParams,queryParamsHandling:""},this.router.navigate(["."],this.navigationExtras)}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(h.qAh))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["records-search-list"]],inputs:{hitList:"hitList",recordsPath:"recordsPath"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["templateNotInfo",""],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[1,"mat-headline-6"],[3,"routerLink"],["color","primary",1,"mat-caption"],["class","p-40",4,"ngIf"],["fxLayout","row wrap",4,"ngIf"],["class","hr-grey-ligth",4,"ngIf"],[1,"p-40"],["fxLayout","row wrap"],["class","li-margin-style",4,"ngFor","ngForOf"],[1,"li-margin-style"],[4,"ngIf"],[1,"hr-grey-ligth"]],template:function(i,s){if(1&i&&(e.YNc(0,z,3,1,"mat-card",0),e.YNc(1,O,4,0,"ng-template",null,1,e.W1O)),2&i){const n=e.MAs(2);e.Q6J("ngIf",s.hitList&&s.hitList.hits.length>0)("ngIfElse",n)}},dependencies:[l.sg,l.O5,l.PC,p.rH,x.a8,x.dn],styles:[".p-40[_ngcontent-%COMP%]{padding-left:40px}.li-margin-style[_ngcontent-%COMP%]{margin:0 8px;list-style:none}.hr-grey-ligth[_ngcontent-%COMP%]{border-color:#fff3}"]})}return a})();var g=o(2557),_=o(8751);let Y=(()=>{class a{constructor(){this.view=[380,370],this.dataChild=[],this.xAxisLabel="",this.gradient=!0,this.showLegend=!1,this.showLabels=!0,this.isDoughnut=!1,this.legendPosition="below",this.colorScheme={domain:["#A9A9A9","#85E96E","#E3E96E","#E9AC6E","#E96E70","#E96EB6","#AE6EE9","#6F6EE9","#6EBBE9","#6EE9B5"]}}ngOnInit(){this.xAxisLabel=this._yAxisLabel}onSelect(t){console.log(t)}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-polar-chart"]],inputs:{dataChild:"dataChild",_yAxisLabel:"_yAxisLabel"},decls:5,vars:9,consts:[["fxLayout","column nowrap","fxLayoutAlign","center center"],[3,"view","scheme","results","gradient","legend","legendPosition","labels","doughnut","select"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"ngx-charts-pie-chart",1),e.NdJ("select",function(c){return s.onSelect(c)}),e.qZA(),e.TgZ(2,"mat-chip-set")(3,"mat-chip"),e._uU(4),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("view",s.view)("scheme",s.colorScheme)("results",s.dataChild)("gradient",s.gradient)("legend",s.showLegend)("legendPosition",s.legendPosition)("labels",s.showLabels)("doughnut",s.isDoughnut),e.xp6(3),e.Oqu(s.xAxisLabel))},dependencies:[g.HS,g.J4,_.JU]})}return a})(),B=(()=>{class a{constructor(){this.bucket=new Array,this.dataChild=[],this.aggrSelect=new e.vpe,this.view=[300,300],this.showXAxis=!1,this.showYAxis=!1,this.gradient=!1,this.showLegend=!1,this.showXAxisLabel=!1,this.showYAxisLabel=!1,this.xAxisLabel="",this.yAxisLabel="",this.maxYAxisTickLength=!1,this.maxXAxisTickLength=!1,this.colorScheme={domain:["#A9A9A9","#85E96E","#E3E96E","#E9AC6E","#E96E70","#E96EB6","#AE6EE9","#6F6EE9","#6EBBE9","#6EE9B5"]}}ngOnInit(){this.xAxisLabel=this._yAxisLabel}onSelect(t){this.aggrSelect.emit({key:this._yAxisLabel,buckets:{name:t.name,value:t.value}})}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-bar-vertical"]],inputs:{dataChild:"dataChild",_yAxisLabel:"_yAxisLabel"},outputs:{aggrSelect:"aggrSelect"},decls:5,vars:14,consts:[["fxLayout","column nowrap","fxLayoutAlign","center center"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","maxYAxisTickLength","maxXAxisTickLength","select"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"ngx-charts-bar-vertical",1),e.NdJ("select",function(c){return s.onSelect(c)}),e.qZA(),e.TgZ(2,"mat-chip-set")(3,"mat-chip"),e._uU(4),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("view",s.view)("scheme",s.colorScheme)("results",s.dataChild)("gradient",s.gradient)("xAxis",s.showXAxis)("yAxis",s.showYAxis)("legend",s.showLegend)("showXAxisLabel",s.showXAxisLabel)("showYAxisLabel",s.showYAxisLabel)("xAxisLabel",s.xAxisLabel)("yAxisLabel",s.yAxisLabel)("maxYAxisTickLength",s.maxYAxisTickLength)("maxXAxisTickLength",s.maxXAxisTickLength),e.xp6(3),e.Oqu(s.xAxisLabel))},dependencies:[g.HS,g.J4,_.K$]})}return a})(),Q=(()=>{class a{constructor(){this.view=[400,400],this.dataChild=[],this.showLegend=!0,this.showLabels=!0,this.colorScheme={domain:["#A9A9A9","#85E96E","#E3E96E","#E9AC6E","#E96E70","#E96EB6","#AE6EE9","#6F6EE9","#6EBBE9","#6EE9B5"]}}ngOnInit(){}onSelect(t){}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-pie-grid"]],inputs:{dataChild:"dataChild",_yAxisLabel:"_yAxisLabel"},decls:5,vars:4,consts:[["fxLayout","column nowrap","fxLayoutAlign","center center"],[3,"view","scheme","results","select"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"ngx-charts-pie-grid",1),e.NdJ("select",function(c){return s.onSelect(c)}),e.qZA(),e.TgZ(2,"mat-chip-set")(3,"mat-chip"),e._uU(4),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("view",s.view)("scheme",s.colorScheme)("results",s.dataChild),e.xp6(3),e.Oqu(s._yAxisLabel))},dependencies:[g.HS,g.J4,_.Nm]})}return a})(),M=(()=>{class a{constructor(){this.view=[400,300],this.legend=!1,this.legendPosition="below",this.xAxisLabel="",this.colorScheme={domain:["#A9A9A9","#85E96E","#E3E96E","#E9AC6E","#E96E70","#E96EB6","#AE6EE9","#6F6EE9","#6EBBE9","#6EE9B5"]}}ngOnInit(){this.xAxisLabel=this._yAxisLabel}onSelect(t){console.log("Item clicked",JSON.parse(JSON.stringify(t)))}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-gauge-chart"]],inputs:{dataChild:"dataChild",_yAxisLabel:"_yAxisLabel"},decls:5,vars:6,consts:[["fxLayout","column nowrap","fxLayoutAlign","center center"],[3,"view","scheme","results","legend","legendPosition","select"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"ngx-charts-gauge",1),e.NdJ("select",function(c){return s.onSelect(c)}),e.qZA(),e.TgZ(2,"mat-chip-set")(3,"mat-chip"),e._uU(4),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("view",s.view)("scheme",s.colorScheme)("results",s.dataChild)("legend",s.legend)("legendPosition",s.legendPosition),e.xp6(3),e.Oqu(s.xAxisLabel))},dependencies:[g.HS,g.J4,_.Ob]})}return a})();function H(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-polar-chart",1),e.NdJ("aggrSelect",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n._aggrSelect(s))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("dataChild",t.charts)("_yAxisLabel",t._yAxisLabel)}}function K(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-bar-vertical",1),e.NdJ("aggrSelect",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n._aggrSelect(s))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("dataChild",t.charts)("_yAxisLabel",t._yAxisLabel)}}function G(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-gauge-chart",1),e.NdJ("aggrSelect",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n._aggrSelect(s))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("dataChild",t.charts)("_yAxisLabel",t._yAxisLabel)}}function U(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-pie-grid",2),e.NdJ("aggrSelect",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n._aggrSelect(s))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("dataChild",t.charts)}}let X=(()=>{class a{constructor(){this.aggrSelected=new e.vpe}ngOnInit(){this.charts=new Array;for(let t=0;t<this.aggregation_value.buckets.length;t++)this.charts.push({name:this.aggregation_value.buckets[t].key,value:this.aggregation_value.buckets[t].doc_count})}_aggrSelect(t){this.aggrSelected.emit(t)}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-charts"]],inputs:{aggregation_value:"aggregation_value",_yAxisLabel:"_yAxisLabel",typeChart:"typeChart"},outputs:{aggrSelected:"aggrSelected"},decls:4,vars:4,consts:[[4,"ngIf"],[3,"dataChild","_yAxisLabel","aggrSelect"],[3,"dataChild","aggrSelect"]],template:function(i,s){1&i&&(e.YNc(0,H,2,2,"ng-container",0),e.YNc(1,K,2,2,"ng-container",0),e.YNc(2,G,2,2,"ng-container",0),e.YNc(3,U,2,1,"ng-container",0)),2&i&&(e.Q6J("ngIf","Polar Chart"==s.typeChart),e.xp6(1),e.Q6J("ngIf","Vertical Bar"==s.typeChart),e.xp6(1),e.Q6J("ngIf","Gauge Chart"==s.typeChart),e.xp6(1),e.Q6J("ngIf","Pie Grid"==s.typeChart))},dependencies:[l.O5,Y,B,Q,M]})}return a})();function j(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"app-charts",2),e.NdJ("aggrSelect",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.selectionChange(s))}),e.qZA()}if(2&a){const t=r.$implicit,i=e.oxw();e.Q6J("typeChart",i.typeChart)("aggregation_value",t.value)("_yAxisLabel",t.key)}}let D=(()=>{class a{constructor(){this.aggregations={},this.selectedAggr={},this.keySelect=new e.vpe,this.keys=[]}ngOnInit(){for(const t in this.aggregations)this.aggregations.hasOwnProperty(t)&&this.keys.push({key:t,sp:this._translate(t)})}_translate(t){switch(t){case"status":return"Estado";case"country":return"Pa\xeds";case"state":return"Provincia (Estado)";case"types":return"Tipos"}return t}selectionChange(t){this.selectedAggr.hasOwnProperty(t.key)||(this.selectedAggr[t.key]=[]),this.selectedAggr[t.key].find(i=>i==t.bucket.name)?this.selectedAggr[t.key]=this.selectedAggr[t.key].filter(i=>i!=t.bucket.name):this.selectedAggr[t.key].push(t.bucket.name),this.keySelect.emit(this.selectedAggr)}static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["toco-search-aggregations-visual"]],inputs:{aggregations:"aggregations",typeChart:"typeChart",selectedAggr:"selectedAggr"},outputs:{keySelect:"keySelect"},decls:2,vars:1,consts:[["fxLayout","row wrap","fxLayoutAlign","space-around center","fxLayoutGap","15px"],[3,"typeChart","aggregation_value","_yAxisLabel","aggrSelect",4,"ngFor","ngForOf"],[3,"typeChart","aggregation_value","_yAxisLabel","aggrSelect"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0),e.YNc(1,j,1,3,"app-charts",1),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngForOf",s.aggregations))},dependencies:[l.sg,X],styles:[".m-1[_ngcontent-%COMP%]{margin:1em}.text-capitalize[_ngcontent-%COMP%]{text-transform:capitalize!important}"]})}return a})();function $(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"seiba-ui-search-aggregations",10),e.NdJ("keySelect",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.aggrChange(s))})("moreKeys",function(s){e.CHM(t);const n=e.oxw();return e.KtG(n.moreKeyClick(s))}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("aggregations",t.sr.aggregations)("selectedAggr",t.aggrsSelection)}}function V(a,r){if(1&a&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.hij(" ",t.search_type," ")}}function W(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"sceiba-ui-search-query-input",14),e.NdJ("queryChange",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.queryChange(s))}),e.qZA()(),e.TgZ(3,"button",15),e.NdJ("click",function(){e.CHM(t),e.oxw(2);const s=e.MAs(6);return e.KtG(s.toggle())}),e.TgZ(4,"mat-icon"),e._uU(5,"filter_list"),e.qZA()(),e.TgZ(6,"mat-paginator",16),e.NdJ("page",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.pageChange(s))}),e.qZA(),e._UZ(7,"records-search-list",17),e.TgZ(8,"mat-paginator",16),e.NdJ("page",function(s){e.CHM(t);const n=e.oxw(2);return e.KtG(n.pageChange(s))}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Q6J("query",t.query),e.xp6(4),e.Q6J("length",t.sr.hits.total)("pageSize",t.pageSize)("pageIndex",t.pageIndex)("pageSizeOptions",t.pageSizeOptions),e.xp6(1),e.Q6J("hitList",t.sr.hits)("recordsPath",t.recordsPath),e.xp6(1),e.Q6J("length",t.sr.hits.total)("pageSize",t.pageSize)("pageIndex",t.pageIndex)("pageSizeOptions",t.pageSizeOptions)}}function ee(a,r){if(1&a&&e.YNc(0,W,9,11,"div",11),2&a){const t=e.oxw();e.Q6J("ngIf",t.sr)}}function te(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"toco-search-aggregations-visual",19),e.NdJ("keySelect",function(s){e.CHM(t);const n=e.oxw(3);return e.KtG(n.aggrChange(s))}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("typeChart",t.typeChart)("aggregations",t.aggr_keys)("selectedAggr",t.aggrsSelection)}}function ae(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"button",15),e.NdJ("click",function(){e.CHM(t),e.oxw(2);const s=e.MAs(6);return e.KtG(s.toggle())}),e.TgZ(3,"mat-icon"),e._uU(4,"filter_list"),e.qZA()(),e._UZ(5,"mat-card"),e.qZA(),e.YNc(6,te,1,3,"toco-search-aggregations-visual",18),e.qZA()}if(2&a){const t=e.oxw(2);e.xp6(6),e.Q6J("ngIf",t.sr)}}function se(a,r){if(1&a&&e.YNc(0,ae,7,1,"div",11),2&a){const t=e.oxw();e.Q6J("ngIf",t.sr)}}const ie=[{path:"",component:(()=>{class a{changeLayoutPosition(t){this.currentlayout=this.layoutPosition[t]}constructor(t,i,s,n,c){this.dialog=t,this._searchService=i,this.activatedRoute=s,this.router=n,this.metadata=c,this.search_type=!0,this.typeChart="Polar Chart",this.layoutPosition=[{name:"Derecha",layout:"row-reverse",aling:"center baseline",width:"22"},{name:"Izquierda",layout:"row",aling:"center baseline",width:"22"},{name:"Arriba",layout:"column",aling:"center center",width:"90"},{name:"Abajo",layout:"column-reverse",aling:"center center",width:"90"}],this.currentlayout=this.layoutPosition[0],this.pageSize=5,this.pageIndex=0,this.pageSizeOptions=[5,15,25,50,100],this.query="",this.aggrsSelection={},this.key_to_open_modal=new e.vpe,this.loading=!0,this.recordsPath=""}onResize(t){this.drawer&&(this.drawer.opened=!(window.innerWidth<=740))}ngAfterViewInit(){this.onResize(null)}ngOnInit(){console.log("ON INIT");let t=this.router.url.split("?");t.length>0&&(this.recordsPath=t[0]),this.activatedRoute.url.subscribe(()=>{}),this.activatedRoute.queryParamMap.subscribe({next:i=>{this.defaultQueryParams(i),this.aggrsSelection={};for(let s=0;s<i.keys.length;s++){const n=i.keys[s];switch(n){case"size":this.pageSize=Number.parseInt(i.get(n));break;case"page":this.pageIndex=Number.parseInt(i.get(n));break;case"q":this.query=i.get(n);break;default:this.aggrsSelection.hasOwnProperty(n)||(this.aggrsSelection[n]=[]),this.aggrsSelection[n].push(i.get(n))}}this.updateFetchParams(),this.fetchSearchRequest(),this.updateMetas()},error:i=>{},complete:()=>{}})}defaultQueryParams(t){t.hasOwnProperty("q")||(this.query=""),t.hasOwnProperty("size")||(this.pageSize=5),t.hasOwnProperty("page")||(this.pageIndex=0)}changeView(){this.search_type=!this.search_type}updateFetchParams(){this.params=new y.LE,this.params=this.params.set("size",this.pageSize.toString(10)),this.params=this.params.set("page",(this.pageIndex+1).toString(10)),this.params=this.params.set("q",this.query);for(const t in this.aggrsSelection)this.aggrsSelection[t].forEach(i=>{this.params=this.params.set(t,i)})}fetchSearchRequest(){this._searchService.getRecords(this.params).subscribe({next:t=>{this.sr=t,this.aggr_keys=[{value:this.sr.aggregations.creators,key:"Creadores"},{value:this.sr.aggregations.keywords,key:"Palabras Claves"},{value:this.sr.aggregations.sources,key:"Fuentes"},{value:this.sr.aggregations.terms,key:"T\xe9rminos"}],this.sr.aggregations.creators.label="Autores",this.sr.aggregations.keywords.label="Palabras Clave",this.sr.aggregations.sources.label="Fuentes",this.sr.aggregations.terms.label="T\xe9rminos",console.log(this.sr)},error:t=>{console.log("ERROPR")},complete:()=>{console.log("END...",this.params,this.query,this.aggrsSelection),this.loading=!1}})}pageChange(t){this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.updateQueryParams()}aggrChange(t){this.aggrsSelection=t,console.log("++++++++++++++++++++++++++++++++++++++++++++++++++++"),console.log(this.aggrsSelection),this.pageSize=5,this.pageIndex=0,this.updateQueryParams()}queryChange(t){this.query!=t&&(this.query=t,this.pageSize=5,this.pageIndex=0,this.updateQueryParams())}moreKeyClick(t){let i=this.sr.aggregations[t].buckets.length,n=[];for(const u in this.aggrsSelection)console.log(u),n.push({key:u,value:this.aggrsSelection[u]});this._searchService.getAggregationTerms({index:"records",filters:n,agg:{filter:t,size:i+5}}).subscribe({next:u=>{u.status==h.Mxn.SUCCESS&&(this.sr.aggregations[t].buckets=u.data.terms)},error:u=>{},complete:()=>{}})}updateQueryParams(){this.loading=!0,this.queryParams={},this.queryParams.size=this.pageSize.toString(10),this.queryParams.page=this.pageIndex.toString(10),this.queryParams.q=this.query;for(const t in this.aggrsSelection)this.aggrsSelection[t].forEach(i=>{this.queryParams[t]=i});this.navigationExtras={relativeTo:this.activatedRoute,queryParams:this.queryParams,queryParamsHandling:""},this.router.navigate(["."],this.navigationExtras)}updateMetas(){this.metadata.meta.updateTag({name:"DC.title",content:"B\xfasqueda de publicaciones cient\xedficas cubanas"}),this.metadata.meta.updateTag({name:"DC.description",content:this.query})}static#e=this.\u0275fac=function(i){return new(i||a)(e.Y36(S.uw),e.Y36(h.oDG),e.Y36(p.gz),e.Y36(p.F0),e.Y36(h.Doh))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["records-app-search"]],viewQuery:function(i,s){if(1&i&&e.Gf(m.jA,5),2&i){let n;e.iGM(n=e.CRH())&&(s.drawer=n.first)}},hostBindings:function(i,s){1&i&&e.NdJ("resize",function(c){return s.onResize(c)},!1,e.Jf7)},outputs:{key_to_open_modal:"key_to_open_modal"},decls:13,vars:5,consts:[[2,"height","80px","padding","0 16px","flex-flow","row wrap","box-sizing","border-box","display","flex","place-content","center space-between","align-items","center"],[1,"mat-h2"],[3,"loading"],["autosize",""],["mode","side","position","start"],["drawer",""],[3,"aggregations","selectedAggr","keySelect","moreKeys",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["search_list",""],["search_charts",""],[3,"aggregations","selectedAggr","keySelect","moreKeys"],["class","m-1",4,"ngIf"],[1,"m-1"],["fxLayout","row nowrap","fxLayoutAlign","space-between center"],[1,"p-1",2,"width","100%",3,"query","queryChange"],["mat-icon-button","","matTooltip","Filtros avanzados",3,"click"],[3,"length","pageSize","pageIndex","pageSizeOptions","page"],[3,"hitList","recordsPath"],[3,"typeChart","aggregations","selectedAggr","keySelect",4,"ngIf"],[3,"typeChart","aggregations","selectedAggr","keySelect"]],template:function(i,s){if(1&i&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2,"B\xfasqueda"),e.qZA()(),e._UZ(3,"toco-progress",2),e.TgZ(4,"mat-drawer-container",3)(5,"mat-drawer",4,5),e.YNc(7,$,1,2,"seiba-ui-search-aggregations",6),e.qZA(),e.YNc(8,V,2,1,"div",7),e.YNc(9,ee,1,1,"ng-template",null,8,e.W1O),e.YNc(11,se,1,1,"ng-template",null,9,e.W1O),e.qZA()),2&i){const n=e.MAs(10),c=e.MAs(12);e.xp6(3),e.Q6J("loading",s.loading),e.xp6(4),e.Q6J("ngIf",s.sr),e.xp6(1),e.Q6J("ngIf",s.search_type)("ngIfThen",n)("ngIfElse",c)}},dependencies:[l.O5,h.t15,A.RK,C.gM,v.Hw,x.a8,m.jA,m.kh,b.NW,w.Y,E.v,F,D],styles:[".example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:40px}.example-margin[_ngcontent-%COMP%]{margin:0 10px}"],data:{animation:[(0,d.X$)("detailExpand",[(0,d.SB)("collapsed",(0,d.oB)({height:"0px",minHeight:"0",display:"none"})),(0,d.SB)("expanded",(0,d.oB)({height:"*"})),(0,d.eR)("expanded <=> collapsed",(0,d.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}return a})()}];let ne=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.oAB({type:a});static#a=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(ie),p.Bz]})}return a})();var re=o(9829),oe=o(6729),ce=o(6208);let ge=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.oAB({type:a});static#a=this.\u0275inj=e.cJS({imports:[l.ez,ne,h.IR2,ce.f,_.a4,h.t8n,re.Cl,oe.C]})}return a})()}}]);